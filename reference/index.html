
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Reference - LMA</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lineage_motif.resample" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="LMA" class="md-header__button md-logo" aria-label="LMA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LMA
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="LMA" class="md-nav__button md-logo" aria-label="LMA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    LMA
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          General
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="General" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          General
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Reference
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample" class="md-nav__link">
    lineage_motif.resample
  </a>
  
    <nav class="md-nav" aria-label="lineage_motif.resample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lineage_motif.resample--lineage_motifresample" class="md-nav__link">
    lineage_motif.resample
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.multi_dataset_resample_trees" class="md-nav__link">
    multi_dataset_resample_trees()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.read_dataset" class="md-nav__link">
    read_dataset()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_asym_quartets" class="md-nav__link">
    resample_trees_asym_quartets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_asym_quintets" class="md-nav__link">
    resample_trees_asym_quintets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_asym_septets" class="md-nav__link">
    resample_trees_asym_septets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_asym_sextets" class="md-nav__link">
    resample_trees_asym_sextets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_doublets" class="md-nav__link">
    resample_trees_doublets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_octets" class="md-nav__link">
    resample_trees_octets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_quartets" class="md-nav__link">
    resample_trees_quartets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_sextets" class="md-nav__link">
    resample_trees_sextets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_triplets" class="md-nav__link">
    resample_trees_triplets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.sort_align_tree" class="md-nav__link">
    sort_align_tree()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot" class="md-nav__link">
    lineage_motif.plot
  </a>
  
    <nav class="md-nav" aria-label="lineage_motif.plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lineage_motif.plot--lineage_motifplot" class="md-nav__link">
    lineage_motif.plot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot.dfs_for_plotting" class="md-nav__link">
    dfs_for_plotting()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot.make_color_dict" class="md-nav__link">
    make_color_dict()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot.multi_dataset_dfs_for_plotting" class="md-nav__link">
    multi_dataset_dfs_for_plotting()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot.multi_dataset_plot_deviation" class="md-nav__link">
    multi_dataset_plot_deviation()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot.plot_deviation" class="md-nav__link">
    plot_deviation()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot.plot_frequency" class="md-nav__link">
    plot_frequency()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.simulate" class="md-nav__link">
    lineage_motif.simulate
  </a>
  
    <nav class="md-nav" aria-label="lineage_motif.simulate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lineage_motif.simulate--lineage_motifsimulate" class="md-nav__link">
    lineage_motif.simulate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.simulate.simulate_tree" class="md-nav__link">
    simulate_tree()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Gallery
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Gallery" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Gallery
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rat_retina/" class="md-nav__link">
        Tutorial 1 - Rat retina
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../zebrafish_retina/" class="md-nav__link">
        Tutorial 2 - Zebrafish retina
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mouse_blastocyst/" class="md-nav__link">
        Tutorial 3 - Mouse blastocyst
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample" class="md-nav__link">
    lineage_motif.resample
  </a>
  
    <nav class="md-nav" aria-label="lineage_motif.resample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lineage_motif.resample--lineage_motifresample" class="md-nav__link">
    lineage_motif.resample
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.multi_dataset_resample_trees" class="md-nav__link">
    multi_dataset_resample_trees()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.read_dataset" class="md-nav__link">
    read_dataset()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_asym_quartets" class="md-nav__link">
    resample_trees_asym_quartets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_asym_quintets" class="md-nav__link">
    resample_trees_asym_quintets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_asym_septets" class="md-nav__link">
    resample_trees_asym_septets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_asym_sextets" class="md-nav__link">
    resample_trees_asym_sextets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_doublets" class="md-nav__link">
    resample_trees_doublets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_octets" class="md-nav__link">
    resample_trees_octets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_quartets" class="md-nav__link">
    resample_trees_quartets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_sextets" class="md-nav__link">
    resample_trees_sextets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.resample_trees_triplets" class="md-nav__link">
    resample_trees_triplets()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.resample.sort_align_tree" class="md-nav__link">
    sort_align_tree()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot" class="md-nav__link">
    lineage_motif.plot
  </a>
  
    <nav class="md-nav" aria-label="lineage_motif.plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lineage_motif.plot--lineage_motifplot" class="md-nav__link">
    lineage_motif.plot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot.dfs_for_plotting" class="md-nav__link">
    dfs_for_plotting()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot.make_color_dict" class="md-nav__link">
    make_color_dict()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot.multi_dataset_dfs_for_plotting" class="md-nav__link">
    multi_dataset_dfs_for_plotting()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot.multi_dataset_plot_deviation" class="md-nav__link">
    multi_dataset_plot_deviation()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot.plot_deviation" class="md-nav__link">
    plot_deviation()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.plot.plot_frequency" class="md-nav__link">
    plot_frequency()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.simulate" class="md-nav__link">
    lineage_motif.simulate
  </a>
  
    <nav class="md-nav" aria-label="lineage_motif.simulate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lineage_motif.simulate--lineage_motifsimulate" class="md-nav__link">
    lineage_motif.simulate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lineage_motif.simulate.simulate_tree" class="md-nav__link">
    simulate_tree()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Reference</h1>

<p>This part of the project documentation focuses on
an <strong>information-oriented</strong> approach. Use it as a
reference for the technical implementation of the
<code>lineage_motif</code> project code.</p>


<div class="doc doc-object doc-module">


<a id="lineage_motif.resample"></a>
  <div class="doc doc-contents first">
  
      <h3 id="lineage_motif.resample--lineage_motifresample">lineage_motif.resample</h3>
<p>Provides functions for resampling tree datasets.</p>
<p>This module contains the following functions:</p>
<ul>
<li><code>sort_align_tree</code> - Sorts and aligns trees.</li>
<li><code>read_dataset</code> - Returns sorted tree dataset.</li>
<li><code>resample_trees_doublets</code> - Returns subtree dictionary and DataFrame containing number of <strong>doublets</strong> across all resamples, the original trees, and the expected number (solved analytically).</li>
<li><code>resample_trees_triplets</code> - Returns subtree dictionary and DataFrame containing number of <strong>triplets</strong> across all resamples, the original trees, and the expected number (solved analytically).</li>
<li><code>resample_trees_quartets</code> - Returns subtree dictionary and DataFrame containing number of <strong>quartets</strong> across all resamples, the original trees, and the expected number (solved analytically).</li>
<li><code>resample_trees_asym_quartets</code> - Returns subtree dictionary and DataFrame containing number of <strong>asymmetric quartets</strong> across all resamples, the original trees, and the expected number (solved analytically).</li>
<li><code>resample_trees_asym_quintets</code> - Returns subtree dictionary and DataFrame containing number of <strong>asymmetric quintets</strong> across all resamples, the original trees, and the expected number (solved analytically).</li>
<li><code>resample_trees_asym_sextets</code> - Returns subtree dictionary and DataFrame containing number of <strong>asymmetric sextets</strong> across all resamples, the original trees, and the expected number (solved analytically).</li>
<li><code>resample_trees_asym_septets</code> - Returns subtree dictionary and DataFrame containing number of <strong>asymmetric septets</strong> across all resamples, the original trees, and the expected number (solved analytically).</li>
<li><code>resample_trees_sextets</code> - Returns subtree dictionary and DataFrame containing number of <strong>sextets</strong> across all resamples, the original trees, and the expected number (solved analytically).</li>
<li><code>resample_trees_octets</code> - Returns subtree dictionary and DataFrame containing number of <strong>octets</strong> across all resamples, the original trees, and the expected number (solved analytically).</li>
<li><code>multi_dataset_resample_trees</code> - Returns subtree dictionary and DataFrame containing number of a defined subtree type across all resamples, the original trees, and the expected number (solved analytically) across all datasets.</li>
</ul>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="lineage_motif.resample.multi_dataset_resample_trees" class="doc doc-heading">
<code class="highlight language-python"><span class="n">multi_dataset_resample_trees</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">dataset_names</span><span class="p">,</span> <span class="n">subtree</span><span class="p">,</span> <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Performs resampling of trees, drawing with or without replacement, returning number of subtrees across
    all resamples, the original trees, and the expected number (solved analytically) 
    <strong>for multiple datasets</strong>. The cell fates used are the composite set across all datasets provided.</p>
<p>Resampling is done as described in each of the <code>resample_trees_subtrees</code> functions.
If <code>cell_fates</code> not explicitly provided, use automatically determined cell fates based on tree datasets.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>datasets</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a path to txt file of dataset. 
txt file should be formatted as NEWICK trees separated with semi-colons and no spaces</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dataset_names</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a string representing the dataset label. </p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>subtree</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>type of subtree to be analyzed. Should be 'doublet', 'triplet', or 'quartet'.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_resamples</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of resample datasets.</p></td>
          <td>
                <code>10000</code>
          </td>
        </tr>
        <tr>
          <td><code>replacement_bool</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Sample cells with or without replacement drawing from the pool of all cells.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>cell_fates</code></td>
          <td>
                <code>string or list</code>
          </td>
          <td><p>If 'auto' (i.e. not provided by user), automatically determined 
based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>Contains the following variables.</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>subtree_dict (dict): Keys are subtrees, values are integers.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>cell_fates (list): List where each entry is a string representing a cell fate.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>dfs_dataset_c (list): List where each entry is a DataFrame with the following characteristics.
Indexed by values from <code>subtree_dict</code>.
Last column is dataset label.
Second to last column is analytically solved expected number of each subtree.
Third to last column is observed number of occurences in the original dataset.
Rest of columns are the observed number of occurences in the resampled sets.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/resample.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2722">2722</a></span>
<span class="normal"><a href="#__codelineno-0-2723">2723</a></span>
<span class="normal"><a href="#__codelineno-0-2724">2724</a></span>
<span class="normal"><a href="#__codelineno-0-2725">2725</a></span>
<span class="normal"><a href="#__codelineno-0-2726">2726</a></span>
<span class="normal"><a href="#__codelineno-0-2727">2727</a></span>
<span class="normal"><a href="#__codelineno-0-2728">2728</a></span>
<span class="normal"><a href="#__codelineno-0-2729">2729</a></span>
<span class="normal"><a href="#__codelineno-0-2730">2730</a></span>
<span class="normal"><a href="#__codelineno-0-2731">2731</a></span>
<span class="normal"><a href="#__codelineno-0-2732">2732</a></span>
<span class="normal"><a href="#__codelineno-0-2733">2733</a></span>
<span class="normal"><a href="#__codelineno-0-2734">2734</a></span>
<span class="normal"><a href="#__codelineno-0-2735">2735</a></span>
<span class="normal"><a href="#__codelineno-0-2736">2736</a></span>
<span class="normal"><a href="#__codelineno-0-2737">2737</a></span>
<span class="normal"><a href="#__codelineno-0-2738">2738</a></span>
<span class="normal"><a href="#__codelineno-0-2739">2739</a></span>
<span class="normal"><a href="#__codelineno-0-2740">2740</a></span>
<span class="normal"><a href="#__codelineno-0-2741">2741</a></span>
<span class="normal"><a href="#__codelineno-0-2742">2742</a></span>
<span class="normal"><a href="#__codelineno-0-2743">2743</a></span>
<span class="normal"><a href="#__codelineno-0-2744">2744</a></span>
<span class="normal"><a href="#__codelineno-0-2745">2745</a></span>
<span class="normal"><a href="#__codelineno-0-2746">2746</a></span>
<span class="normal"><a href="#__codelineno-0-2747">2747</a></span>
<span class="normal"><a href="#__codelineno-0-2748">2748</a></span>
<span class="normal"><a href="#__codelineno-0-2749">2749</a></span>
<span class="normal"><a href="#__codelineno-0-2750">2750</a></span>
<span class="normal"><a href="#__codelineno-0-2751">2751</a></span>
<span class="normal"><a href="#__codelineno-0-2752">2752</a></span>
<span class="normal"><a href="#__codelineno-0-2753">2753</a></span>
<span class="normal"><a href="#__codelineno-0-2754">2754</a></span>
<span class="normal"><a href="#__codelineno-0-2755">2755</a></span>
<span class="normal"><a href="#__codelineno-0-2756">2756</a></span>
<span class="normal"><a href="#__codelineno-0-2757">2757</a></span>
<span class="normal"><a href="#__codelineno-0-2758">2758</a></span>
<span class="normal"><a href="#__codelineno-0-2759">2759</a></span>
<span class="normal"><a href="#__codelineno-0-2760">2760</a></span>
<span class="normal"><a href="#__codelineno-0-2761">2761</a></span>
<span class="normal"><a href="#__codelineno-0-2762">2762</a></span>
<span class="normal"><a href="#__codelineno-0-2763">2763</a></span>
<span class="normal"><a href="#__codelineno-0-2764">2764</a></span>
<span class="normal"><a href="#__codelineno-0-2765">2765</a></span>
<span class="normal"><a href="#__codelineno-0-2766">2766</a></span>
<span class="normal"><a href="#__codelineno-0-2767">2767</a></span>
<span class="normal"><a href="#__codelineno-0-2768">2768</a></span>
<span class="normal"><a href="#__codelineno-0-2769">2769</a></span>
<span class="normal"><a href="#__codelineno-0-2770">2770</a></span>
<span class="normal"><a href="#__codelineno-0-2771">2771</a></span>
<span class="normal"><a href="#__codelineno-0-2772">2772</a></span>
<span class="normal"><a href="#__codelineno-0-2773">2773</a></span>
<span class="normal"><a href="#__codelineno-0-2774">2774</a></span>
<span class="normal"><a href="#__codelineno-0-2775">2775</a></span>
<span class="normal"><a href="#__codelineno-0-2776">2776</a></span>
<span class="normal"><a href="#__codelineno-0-2777">2777</a></span>
<span class="normal"><a href="#__codelineno-0-2778">2778</a></span>
<span class="normal"><a href="#__codelineno-0-2779">2779</a></span>
<span class="normal"><a href="#__codelineno-0-2780">2780</a></span>
<span class="normal"><a href="#__codelineno-0-2781">2781</a></span>
<span class="normal"><a href="#__codelineno-0-2782">2782</a></span>
<span class="normal"><a href="#__codelineno-0-2783">2783</a></span>
<span class="normal"><a href="#__codelineno-0-2784">2784</a></span>
<span class="normal"><a href="#__codelineno-0-2785">2785</a></span>
<span class="normal"><a href="#__codelineno-0-2786">2786</a></span>
<span class="normal"><a href="#__codelineno-0-2787">2787</a></span>
<span class="normal"><a href="#__codelineno-0-2788">2788</a></span>
<span class="normal"><a href="#__codelineno-0-2789">2789</a></span>
<span class="normal"><a href="#__codelineno-0-2790">2790</a></span>
<span class="normal"><a href="#__codelineno-0-2791">2791</a></span>
<span class="normal"><a href="#__codelineno-0-2792">2792</a></span>
<span class="normal"><a href="#__codelineno-0-2793">2793</a></span>
<span class="normal"><a href="#__codelineno-0-2794">2794</a></span>
<span class="normal"><a href="#__codelineno-0-2795">2795</a></span>
<span class="normal"><a href="#__codelineno-0-2796">2796</a></span>
<span class="normal"><a href="#__codelineno-0-2797">2797</a></span>
<span class="normal"><a href="#__codelineno-0-2798">2798</a></span>
<span class="normal"><a href="#__codelineno-0-2799">2799</a></span>
<span class="normal"><a href="#__codelineno-0-2800">2800</a></span>
<span class="normal"><a href="#__codelineno-0-2801">2801</a></span>
<span class="normal"><a href="#__codelineno-0-2802">2802</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2722" name="__codelineno-0-2722"></a><span class="k">def</span> <span class="nf">multi_dataset_resample_trees</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span>
<a id="__codelineno-0-2723" name="__codelineno-0-2723"></a>                                 <span class="n">dataset_names</span><span class="p">,</span>
<a id="__codelineno-0-2724" name="__codelineno-0-2724"></a>                                 <span class="n">subtree</span><span class="p">,</span>
<a id="__codelineno-0-2725" name="__codelineno-0-2725"></a>                                 <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> 
<a id="__codelineno-0-2726" name="__codelineno-0-2726"></a>                                 <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
<a id="__codelineno-0-2727" name="__codelineno-0-2727"></a>                                 <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
<a id="__codelineno-0-2728" name="__codelineno-0-2728"></a>                                 <span class="p">):</span>
<a id="__codelineno-0-2729" name="__codelineno-0-2729"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs resampling of trees, drawing with or without replacement, returning number of subtrees across</span>
<a id="__codelineno-0-2730" name="__codelineno-0-2730"></a><span class="sd">        all resamples, the original trees, and the expected number (solved analytically) </span>
<a id="__codelineno-0-2731" name="__codelineno-0-2731"></a><span class="sd">        **for multiple datasets**. The cell fates used are the composite set across all datasets provided.</span>
<a id="__codelineno-0-2732" name="__codelineno-0-2732"></a>
<a id="__codelineno-0-2733" name="__codelineno-0-2733"></a><span class="sd">    Resampling is done as described in each of the `resample_trees_subtrees` functions.</span>
<a id="__codelineno-0-2734" name="__codelineno-0-2734"></a><span class="sd">    If `cell_fates` not explicitly provided, use automatically determined cell fates based on tree datasets.</span>
<a id="__codelineno-0-2735" name="__codelineno-0-2735"></a>
<a id="__codelineno-0-2736" name="__codelineno-0-2736"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2737" name="__codelineno-0-2737"></a><span class="sd">        datasets (list): List where each entry is a path to txt file of dataset. </span>
<a id="__codelineno-0-2738" name="__codelineno-0-2738"></a><span class="sd">            txt file should be formatted as NEWICK trees separated with semi-colons and no spaces</span>
<a id="__codelineno-0-2739" name="__codelineno-0-2739"></a><span class="sd">        dataset_names (list): List where each entry is a string representing the dataset label. </span>
<a id="__codelineno-0-2740" name="__codelineno-0-2740"></a><span class="sd">        subtree (string): type of subtree to be analyzed. Should be &#39;doublet&#39;, &#39;triplet&#39;, or &#39;quartet&#39;.</span>
<a id="__codelineno-0-2741" name="__codelineno-0-2741"></a><span class="sd">        num_resamples (int, optional): Number of resample datasets.</span>
<a id="__codelineno-0-2742" name="__codelineno-0-2742"></a><span class="sd">        replacement_bool (bool, optional): Sample cells with or without replacement drawing from the pool of all cells.</span>
<a id="__codelineno-0-2743" name="__codelineno-0-2743"></a><span class="sd">        cell_fates (string or list, optional): If &#39;auto&#39; (i.e. not provided by user), automatically determined </span>
<a id="__codelineno-0-2744" name="__codelineno-0-2744"></a><span class="sd">            based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-2745" name="__codelineno-0-2745"></a>
<a id="__codelineno-0-2746" name="__codelineno-0-2746"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2747" name="__codelineno-0-2747"></a><span class="sd">        (tuple): Contains the following variables.</span>
<a id="__codelineno-0-2748" name="__codelineno-0-2748"></a><span class="sd">        - subtree_dict (dict): Keys are subtrees, values are integers.</span>
<a id="__codelineno-0-2749" name="__codelineno-0-2749"></a><span class="sd">        - cell_fates (list): List where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-2750" name="__codelineno-0-2750"></a><span class="sd">        - dfs_dataset_c (list): List where each entry is a DataFrame with the following characteristics.</span>
<a id="__codelineno-0-2751" name="__codelineno-0-2751"></a><span class="sd">            Indexed by values from `subtree_dict`.</span>
<a id="__codelineno-0-2752" name="__codelineno-0-2752"></a><span class="sd">            Last column is dataset label.</span>
<a id="__codelineno-0-2753" name="__codelineno-0-2753"></a><span class="sd">            Second to last column is analytically solved expected number of each subtree.</span>
<a id="__codelineno-0-2754" name="__codelineno-0-2754"></a><span class="sd">            Third to last column is observed number of occurences in the original dataset.</span>
<a id="__codelineno-0-2755" name="__codelineno-0-2755"></a><span class="sd">            Rest of columns are the observed number of occurences in the resampled sets.</span>
<a id="__codelineno-0-2756" name="__codelineno-0-2756"></a>
<a id="__codelineno-0-2757" name="__codelineno-0-2757"></a>
<a id="__codelineno-0-2758" name="__codelineno-0-2758"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2759" name="__codelineno-0-2759"></a>    <span class="c1"># automatically determine cell fates if not explicitly provided</span>
<a id="__codelineno-0-2760" name="__codelineno-0-2760"></a>    <span class="k">if</span> <span class="n">cell_fates</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2761" name="__codelineno-0-2761"></a>        <span class="n">all_trees_sorted_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2762" name="__codelineno-0-2762"></a>        <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
<a id="__codelineno-0-2763" name="__codelineno-0-2763"></a>            <span class="n">all_trees_sorted</span> <span class="o">=</span> <span class="n">read_dataset</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<a id="__codelineno-0-2764" name="__codelineno-0-2764"></a>            <span class="n">all_trees_sorted_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-2765" name="__codelineno-0-2765"></a>        <span class="n">all_trees_sorted_list_flattened</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">all_trees_sorted_list</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
<a id="__codelineno-0-2766" name="__codelineno-0-2766"></a>        <span class="n">cell_fates</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[A-Z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">all_trees_sorted_list_flattened</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])))))</span>
<a id="__codelineno-0-2767" name="__codelineno-0-2767"></a>
<a id="__codelineno-0-2768" name="__codelineno-0-2768"></a>    <span class="c1"># _make_subtree_dict functions can only handle 10 cell fates max</span>
<a id="__codelineno-0-2769" name="__codelineno-0-2769"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-2770" name="__codelineno-0-2770"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2771" name="__codelineno-0-2771"></a>
<a id="__codelineno-0-2772" name="__codelineno-0-2772"></a>    <span class="c1"># next, resample each dataset using composite cell fates list</span>
<a id="__codelineno-0-2773" name="__codelineno-0-2773"></a>    <span class="n">dfs_dataset_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2774" name="__codelineno-0-2774"></a>    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">datasets</span><span class="p">)):</span>
<a id="__codelineno-0-2775" name="__codelineno-0-2775"></a>        <span class="n">all_trees_sorted</span> <span class="o">=</span> <span class="n">read_dataset</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<a id="__codelineno-0-2776" name="__codelineno-0-2776"></a>        <span class="k">if</span> <span class="n">subtree</span> <span class="o">==</span> <span class="s1">&#39;doublet&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2777" name="__codelineno-0-2777"></a>            <span class="p">(</span><span class="n">subtree_dict</span><span class="p">,</span> <span class="n">cell_fates</span><span class="p">,</span> <span class="n">dfs_dataset</span><span class="p">)</span> <span class="o">=</span> <span class="n">resample_trees_doublets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> 
<a id="__codelineno-0-2778" name="__codelineno-0-2778"></a>                                                          <span class="n">num_resamples</span><span class="p">,</span> 
<a id="__codelineno-0-2779" name="__codelineno-0-2779"></a>                                                          <span class="n">replacement_bool</span><span class="p">,</span>
<a id="__codelineno-0-2780" name="__codelineno-0-2780"></a>                                                          <span class="n">cell_fates</span><span class="o">=</span><span class="n">cell_fates</span>
<a id="__codelineno-0-2781" name="__codelineno-0-2781"></a>                                                          <span class="p">)</span>
<a id="__codelineno-0-2782" name="__codelineno-0-2782"></a>            <span class="n">dfs_dataset</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<a id="__codelineno-0-2783" name="__codelineno-0-2783"></a>
<a id="__codelineno-0-2784" name="__codelineno-0-2784"></a>        <span class="k">elif</span> <span class="n">subtree</span> <span class="o">==</span> <span class="s1">&#39;triplet&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2785" name="__codelineno-0-2785"></a>            <span class="p">(</span><span class="n">subtree_dict</span><span class="p">,</span> <span class="n">cell_fates</span><span class="p">,</span> <span class="n">dfs_dataset</span><span class="p">)</span> <span class="o">=</span> <span class="n">resample_trees_triplets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> 
<a id="__codelineno-0-2786" name="__codelineno-0-2786"></a>                                                          <span class="n">num_resamples</span><span class="p">,</span> 
<a id="__codelineno-0-2787" name="__codelineno-0-2787"></a>                                                          <span class="n">replacement_bool</span><span class="p">,</span>
<a id="__codelineno-0-2788" name="__codelineno-0-2788"></a>                                                          <span class="n">cell_fates</span><span class="o">=</span><span class="n">cell_fates</span>
<a id="__codelineno-0-2789" name="__codelineno-0-2789"></a>                                                          <span class="p">)</span>
<a id="__codelineno-0-2790" name="__codelineno-0-2790"></a>            <span class="n">dfs_dataset</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<a id="__codelineno-0-2791" name="__codelineno-0-2791"></a>
<a id="__codelineno-0-2792" name="__codelineno-0-2792"></a>        <span class="k">elif</span> <span class="n">subtree</span> <span class="o">==</span> <span class="s1">&#39;quartet&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2793" name="__codelineno-0-2793"></a>            <span class="p">(</span><span class="n">subtree_dict</span><span class="p">,</span> <span class="n">cell_fates</span><span class="p">,</span> <span class="n">dfs_dataset</span><span class="p">)</span> <span class="o">=</span> <span class="n">resample_trees_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> 
<a id="__codelineno-0-2794" name="__codelineno-0-2794"></a>                                                          <span class="n">num_resamples</span><span class="p">,</span> 
<a id="__codelineno-0-2795" name="__codelineno-0-2795"></a>                                                          <span class="n">replacement_bool</span><span class="p">,</span>
<a id="__codelineno-0-2796" name="__codelineno-0-2796"></a>                                                          <span class="n">cell_fates</span><span class="o">=</span><span class="n">cell_fates</span>
<a id="__codelineno-0-2797" name="__codelineno-0-2797"></a>                                                          <span class="p">)</span>
<a id="__codelineno-0-2798" name="__codelineno-0-2798"></a>            <span class="n">dfs_dataset</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<a id="__codelineno-0-2799" name="__codelineno-0-2799"></a>
<a id="__codelineno-0-2800" name="__codelineno-0-2800"></a>        <span class="n">dfs_dataset_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dfs_dataset</span><span class="p">)</span>
<a id="__codelineno-0-2801" name="__codelineno-0-2801"></a>    <span class="n">dfs_dataset_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs_dataset_list</span><span class="p">)</span>
<a id="__codelineno-0-2802" name="__codelineno-0-2802"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">subtree_dict</span><span class="p">,</span> <span class="n">cell_fates</span><span class="p">,</span> <span class="n">dfs_dataset_c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.resample.read_dataset" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Reads dataset txt file located at <code>path</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Path to txt file of dataset. txt file should be formatted as NEWICK trees 
separated with semi-colons and no spaces.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>all_trees_sorted</code></td>          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a string representing a tree in NEWICK format. 
Trees are sorted using the <code>sort_align_tree</code> function.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/resample.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="k">def</span> <span class="nf">read_dataset</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads dataset txt file located at `path`.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        path (string): Path to txt file of dataset. txt file should be formatted as NEWICK trees </span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            separated with semi-colons and no spaces.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        all_trees_sorted (list): List where each entry is a string representing a tree in NEWICK format. </span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            Trees are sorted using the `sort_align_tree` function.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">all_trees_unsorted</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">all_trees_sorted</span> <span class="o">=</span> <span class="p">[</span><span class="n">sort_align_tree</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_trees_unsorted</span><span class="p">]</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">return</span> <span class="n">all_trees_sorted</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.resample.resample_trees_asym_quartets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">resample_trees_asym_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing 
number of asymmetric quartets across all resamples, the original trees, and the expected number (solved analytically).</p>
<p>Resampling is done via (1) replacing each triplet with a randomly chosen triplet across all trees and 
(2) replacing every other cell with a randomly chosen non-triplet cell across all trees.
If <code>cell_fates</code> not explicitly provided, use automatically determined cell fates based on tree dataset.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>all_trees_sorted</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a string representing a tree in NEWICK format. 
Trees are sorted using the <code>sort_align_tree</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_resamples</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of resample datasets.</p></td>
          <td>
                <code>10000</code>
          </td>
        </tr>
        <tr>
          <td><code>replacement_bool</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Sample cells with or without replacement drawing from the pool of all cells.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>cell_fates</code></td>
          <td>
                <code>string or list</code>
          </td>
          <td><p>If 'auto' (i.e. not provided by user), automatically determined 
based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>calc_expected</code></td>
          <td>
                <code>Boolean</code>
          </td>
          <td><p>Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>Contains the following variables.</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>asym_quartet_dict (dict): Keys are asym_quartets, values are integers.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>cell_fates (list): List where each entry is a string representing a cell fate.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>dfs_c (DataFrame): Indexed by values from <code>asym_quartet_dict</code>.
Last column is analytically solved expected number of each asym_quartet.
Second to last column is observed number of occurences in the original dataset.
Rest of columns are the observed number of occurences in the resampled sets.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/resample.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="k">def</span> <span class="nf">resample_trees_asym_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> 
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>                            <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> 
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>                            <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>                            <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>                            <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>                           <span class="p">):</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing </span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="sd">    number of asymmetric quartets across all resamples, the original trees, and the expected number (solved analytically).</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><span class="sd">    Resampling is done via (1) replacing each triplet with a randomly chosen triplet across all trees and </span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">    (2) replacing every other cell with a randomly chosen non-triplet cell across all trees.</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">    If `cell_fates` not explicitly provided, use automatically determined cell fates based on tree dataset.</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a><span class="sd">        all_trees_sorted (list): List where each entry is a string representing a tree in NEWICK format. </span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="sd">            Trees are sorted using the `sort_align_tree` function.</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><span class="sd">        num_resamples (int, optional): Number of resample datasets.</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><span class="sd">        replacement_bool (bool, optional): Sample cells with or without replacement drawing from the pool of all cells.</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">        cell_fates (string or list, optional): If &#39;auto&#39; (i.e. not provided by user), automatically determined </span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a><span class="sd">            based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">        calc_expected (Boolean): Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a><span class="sd">        (tuple): Contains the following variables.</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a><span class="sd">        - asym_quartet_dict (dict): Keys are asym_quartets, values are integers.</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="sd">        - cell_fates (list): List where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a><span class="sd">        - dfs_c (DataFrame): Indexed by values from `asym_quartet_dict`.</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a><span class="sd">            Last column is analytically solved expected number of each asym_quartet.</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a><span class="sd">            Second to last column is observed number of occurences in the original dataset.</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">            Rest of columns are the observed number of occurences in the resampled sets.</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>    <span class="c1"># automatically determine cell fates if not explicitly provided</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>    <span class="k">if</span> <span class="n">cell_fates</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>        <span class="n">cell_fates</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[A-Z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])))))</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>    <span class="c1"># _make_subtree_dict functions can only handle 10 cell fates max</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a>    <span class="n">asym_quartet_dict</span> <span class="o">=</span> <span class="n">_make_asym_quartet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>    <span class="n">triplet_dict</span> <span class="o">=</span> <span class="n">_make_triplet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>    <span class="n">cell_dict</span> <span class="o">=</span> <span class="n">_make_cell_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>    <span class="c1"># store result for each rearrangement in dfs list</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>    <span class="n">dfs_asym_quartets_new</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>    <span class="n">df_asym_quartets_true</span> <span class="o">=</span> <span class="n">_make_df_asym_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">asym_quartet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>    <span class="n">df_triplets_true</span> <span class="o">=</span> <span class="n">_make_df_triplets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">triplet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>    <span class="n">df_non_triplets_true</span> <span class="o">=</span> <span class="n">_make_df_non_triplets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">cell_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>    <span class="c1"># rearrange leaves num_resamples times</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>    <span class="k">for</span> <span class="n">resample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">)):</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a>        <span class="n">triplets_true</span> <span class="o">=</span> <span class="n">_flatten_triplets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>        <span class="n">non_triplets_true</span> <span class="o">=</span> <span class="n">_flatten_non_triplets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a>        <span class="c1"># shuffle if replacement=False</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a>        <span class="k">if</span> <span class="n">replacement_bool</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">triplets_true</span><span class="p">)</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">non_triplets_true</span><span class="p">)</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a>        <span class="c1"># first, replace the doublet with a symbol</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a>        <span class="n">new_trees_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_triplets_symbol</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span><span class="p">]</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>        <span class="c1"># then, replace all other cells </span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a>        <span class="n">new_trees_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_all</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">non_triplets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_trees_1</span><span class="p">]</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a>        <span class="c1"># then, replace the symbols</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>        <span class="n">new_trees_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_symbols</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">triplets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_trees_2</span><span class="p">]</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a>        <span class="n">df_asym_quartets_new</span> <span class="o">=</span> <span class="n">_make_df_asym_quartets</span><span class="p">(</span><span class="n">new_trees_3</span><span class="p">,</span> <span class="n">asym_quartet_dict</span><span class="p">,</span> <span class="n">resample</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>        <span class="n">dfs_asym_quartets_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_asym_quartets_new</span><span class="p">)</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a>    <span class="n">dfs_c</span> <span class="o">=</span> <span class="n">_process_dfs_asym_quartet</span><span class="p">(</span><span class="n">df_asym_quartets_true</span><span class="p">,</span> <span class="n">dfs_asym_quartets_new</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">,</span> <span class="n">asym_quartet_dict</span><span class="p">,</span> <span class="n">triplet_dict</span><span class="p">,</span> <span class="n">cell_dict</span><span class="p">,</span> <span class="n">df_triplets_true</span><span class="p">,</span> <span class="n">df_non_triplets_true</span><span class="p">,</span> <span class="n">calc_expected</span><span class="p">)</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">asym_quartet_dict</span><span class="p">,</span> <span class="n">cell_fates</span><span class="p">,</span> <span class="n">dfs_c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.resample.resample_trees_asym_quintets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">resample_trees_asym_quintets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing 
number of asymmetric quartets across all resamples, the original trees, and the expected number (solved analytically).</p>
<p>Resampling is done via (1) replacing each asymmetric quartet with a randomly chosen asymmetric quartet across all trees and 
(2) replacing every other cell with a randomly chosen non-asymmetric quartet cell across all trees.
If <code>cell_fates</code> not explicitly provided, use automatically determined cell fates based on tree dataset.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>all_trees_sorted</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a string representing a tree in NEWICK format. 
Trees are sorted using the <code>sort_align_tree</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_resamples</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of resample datasets.</p></td>
          <td>
                <code>10000</code>
          </td>
        </tr>
        <tr>
          <td><code>replacement_bool</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Sample cells with or without replacement drawing from the pool of all cells.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>cell_fates</code></td>
          <td>
                <code>string or list</code>
          </td>
          <td><p>If 'auto' (i.e. not provided by user), automatically determined 
based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>calc_expected</code></td>
          <td>
                <code>Boolean</code>
          </td>
          <td><p>Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>Contains the following variables.</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>asym_quintet_dict (dict): Keys are asym_quintets, values are integers.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>cell_fates (list): List where each entry is a string representing a cell fate.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>dfs_c (DataFrame): Indexed by values from <code>asym_quintet_dict</code>.
Last column is analytically solved expected number of each asym_quintet.
Second to last column is observed number of occurences in the original dataset.
Rest of columns are the observed number of occurences in the resampled sets.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/resample.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1554" name="__codelineno-0-1554"></a><span class="k">def</span> <span class="nf">resample_trees_asym_quintets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> 
<a id="__codelineno-0-1555" name="__codelineno-0-1555"></a>                            <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> 
<a id="__codelineno-0-1556" name="__codelineno-0-1556"></a>                            <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1557" name="__codelineno-0-1557"></a>                            <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-1558" name="__codelineno-0-1558"></a>                            <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-1559" name="__codelineno-0-1559"></a>                           <span class="p">):</span>
<a id="__codelineno-0-1560" name="__codelineno-0-1560"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing </span>
<a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><span class="sd">    number of asymmetric quartets across all resamples, the original trees, and the expected number (solved analytically).</span>
<a id="__codelineno-0-1562" name="__codelineno-0-1562"></a>
<a id="__codelineno-0-1563" name="__codelineno-0-1563"></a><span class="sd">    Resampling is done via (1) replacing each asymmetric quartet with a randomly chosen asymmetric quartet across all trees and </span>
<a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><span class="sd">    (2) replacing every other cell with a randomly chosen non-asymmetric quartet cell across all trees.</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565"></a><span class="sd">    If `cell_fates` not explicitly provided, use automatically determined cell fates based on tree dataset.</span>
<a id="__codelineno-0-1566" name="__codelineno-0-1566"></a>
<a id="__codelineno-0-1567" name="__codelineno-0-1567"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1568" name="__codelineno-0-1568"></a><span class="sd">        all_trees_sorted (list): List where each entry is a string representing a tree in NEWICK format. </span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569"></a><span class="sd">            Trees are sorted using the `sort_align_tree` function.</span>
<a id="__codelineno-0-1570" name="__codelineno-0-1570"></a><span class="sd">        num_resamples (int, optional): Number of resample datasets.</span>
<a id="__codelineno-0-1571" name="__codelineno-0-1571"></a><span class="sd">        replacement_bool (bool, optional): Sample cells with or without replacement drawing from the pool of all cells.</span>
<a id="__codelineno-0-1572" name="__codelineno-0-1572"></a><span class="sd">        cell_fates (string or list, optional): If &#39;auto&#39; (i.e. not provided by user), automatically determined </span>
<a id="__codelineno-0-1573" name="__codelineno-0-1573"></a><span class="sd">            based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-1574" name="__codelineno-0-1574"></a><span class="sd">        calc_expected (Boolean): Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</span>
<a id="__codelineno-0-1575" name="__codelineno-0-1575"></a>
<a id="__codelineno-0-1576" name="__codelineno-0-1576"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><span class="sd">        (tuple): Contains the following variables.</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578"></a><span class="sd">        - asym_quintet_dict (dict): Keys are asym_quintets, values are integers.</span>
<a id="__codelineno-0-1579" name="__codelineno-0-1579"></a><span class="sd">        - cell_fates (list): List where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-1580" name="__codelineno-0-1580"></a><span class="sd">        - dfs_c (DataFrame): Indexed by values from `asym_quintet_dict`.</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a><span class="sd">            Last column is analytically solved expected number of each asym_quintet.</span>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a><span class="sd">            Second to last column is observed number of occurences in the original dataset.</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a><span class="sd">            Rest of columns are the observed number of occurences in the resampled sets.</span>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a>    <span class="c1"># automatically determine cell fates if not explicitly provided</span>
<a id="__codelineno-0-1586" name="__codelineno-0-1586"></a>    <span class="k">if</span> <span class="n">cell_fates</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1587" name="__codelineno-0-1587"></a>        <span class="n">cell_fates</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[A-Z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])))))</span>
<a id="__codelineno-0-1588" name="__codelineno-0-1588"></a>
<a id="__codelineno-0-1589" name="__codelineno-0-1589"></a>    <span class="c1"># _make_subtree_dict functions can only handle 10 cell fates max</span>
<a id="__codelineno-0-1590" name="__codelineno-0-1590"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-1591" name="__codelineno-0-1591"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning, _make_subtree_dict functions can only handle 10 cell fates max!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>    <span class="n">asym_quintet_dict</span> <span class="o">=</span> <span class="n">_make_asym_quintet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>    <span class="n">asym_quartet_dict</span> <span class="o">=</span> <span class="n">_make_asym_quartet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>    <span class="n">cell_dict</span> <span class="o">=</span> <span class="n">_make_cell_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>    <span class="c1"># store result for each rearrangement in dfs list</span>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a>    <span class="n">dfs_asym_quintets_new</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1599" name="__codelineno-0-1599"></a>    <span class="n">df_asym_quintets_true</span> <span class="o">=</span> <span class="n">_make_df_asym_quintets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">asym_quintet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1600" name="__codelineno-0-1600"></a>    <span class="n">df_asym_quartets_true</span> <span class="o">=</span> <span class="n">_make_df_asym_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">asym_quartet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a>    <span class="n">df_non_asym_quartets_true</span> <span class="o">=</span> <span class="n">_make_df_non_asym_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">cell_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>    <span class="c1"># rearrange leaves num_resamples times</span>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a>    <span class="k">for</span> <span class="n">resample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">)):</span>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a>        <span class="n">asym_quartets_true</span> <span class="o">=</span> <span class="n">_flatten_asym_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a>        <span class="n">non_asym_quartets_true</span> <span class="o">=</span> <span class="n">_flatten_non_asym_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-1607" name="__codelineno-0-1607"></a>
<a id="__codelineno-0-1608" name="__codelineno-0-1608"></a>        <span class="c1"># shuffle if replacement=False</span>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a>        <span class="k">if</span> <span class="n">replacement_bool</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">asym_quartets_true</span><span class="p">)</span>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">non_asym_quartets_true</span><span class="p">)</span>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a>        <span class="c1"># first, replace the doublet with a symbol</span>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a>        <span class="n">new_trees_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_asym_quartets_symbol</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span><span class="p">]</span>
<a id="__codelineno-0-1615" name="__codelineno-0-1615"></a>        <span class="c1"># then, replace all other cells </span>
<a id="__codelineno-0-1616" name="__codelineno-0-1616"></a>        <span class="n">new_trees_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_all</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">non_asym_quartets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_trees_1</span><span class="p">]</span>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a>        <span class="c1"># then, replace the symbols</span>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>        <span class="n">new_trees_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_symbols</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">asym_quartets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_trees_2</span><span class="p">]</span>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>        <span class="n">df_asym_quintets_new</span> <span class="o">=</span> <span class="n">_make_df_asym_quintets</span><span class="p">(</span><span class="n">new_trees_3</span><span class="p">,</span> <span class="n">asym_quintet_dict</span><span class="p">,</span> <span class="n">resample</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a>        <span class="n">dfs_asym_quintets_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_asym_quintets_new</span><span class="p">)</span>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>    <span class="n">dfs_c</span> <span class="o">=</span> <span class="n">_process_dfs_asym_quintet</span><span class="p">(</span><span class="n">df_asym_quintets_true</span><span class="p">,</span> <span class="n">dfs_asym_quintets_new</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">,</span> <span class="n">asym_quintet_dict</span><span class="p">,</span> <span class="n">asym_quartet_dict</span><span class="p">,</span> <span class="n">cell_dict</span><span class="p">,</span> <span class="n">df_asym_quartets_true</span><span class="p">,</span> <span class="n">df_non_asym_quartets_true</span><span class="p">,</span> <span class="n">calc_expected</span><span class="p">)</span>
<a id="__codelineno-0-1623" name="__codelineno-0-1623"></a>
<a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">asym_quintet_dict</span><span class="p">,</span> <span class="n">cell_fates</span><span class="p">,</span> <span class="n">dfs_c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.resample.resample_trees_asym_septets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">resample_trees_asym_septets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing 
number of asymmetric septets across all resamples, the original trees, and the expected number (solved analytically).</p>
<p>Resampling is done via (1) replacing each asymmetric sextet with a randomly chosen asymmetric sextet across all trees and 
(2) replacing every other cell with a randomly chosen non-asymmetric sextet cell across all trees.
If <code>cell_fates</code> not explicitly provided, use automatically determined cell fates based on tree dataset.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>all_trees_sorted</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a string representing a tree in NEWICK format. 
Trees are sorted using the <code>sort_align_tree</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_resamples</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of resample datasets.</p></td>
          <td>
                <code>10000</code>
          </td>
        </tr>
        <tr>
          <td><code>replacement_bool</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Sample cells with or without replacement drawing from the pool of all cells.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>cell_fates</code></td>
          <td>
                <code>string or list</code>
          </td>
          <td><p>If 'auto' (i.e. not provided by user), automatically determined 
based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>calc_expected</code></td>
          <td>
                <code>Boolean</code>
          </td>
          <td><p>Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>Contains the following variables.</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>asym_septet_dict (dict): Keys are asym_septets, values are integers.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>cell_fates (list): List where each entry is a string representing a cell fate.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>dfs_c (DataFrame): Indexed by values from <code>asym_septet_dict</code>.
Last column is analytically solved expected number of each asym_septet.
Second to last column is observed number of occurences in the original dataset.
Rest of columns are the observed number of occurences in the resampled sets.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/resample.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span>
<span class="normal"><a href="#__codelineno-0-2135">2135</a></span>
<span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span>
<span class="normal"><a href="#__codelineno-0-2138">2138</a></span>
<span class="normal"><a href="#__codelineno-0-2139">2139</a></span>
<span class="normal"><a href="#__codelineno-0-2140">2140</a></span>
<span class="normal"><a href="#__codelineno-0-2141">2141</a></span>
<span class="normal"><a href="#__codelineno-0-2142">2142</a></span>
<span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2133" name="__codelineno-0-2133"></a><span class="k">def</span> <span class="nf">resample_trees_asym_septets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> 
<a id="__codelineno-0-2134" name="__codelineno-0-2134"></a>                            <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> 
<a id="__codelineno-0-2135" name="__codelineno-0-2135"></a>                            <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2136" name="__codelineno-0-2136"></a>                            <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
<a id="__codelineno-0-2137" name="__codelineno-0-2137"></a>                            <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-2138" name="__codelineno-0-2138"></a>                           <span class="p">):</span>
<a id="__codelineno-0-2139" name="__codelineno-0-2139"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing </span>
<a id="__codelineno-0-2140" name="__codelineno-0-2140"></a><span class="sd">    number of asymmetric septets across all resamples, the original trees, and the expected number (solved analytically).</span>
<a id="__codelineno-0-2141" name="__codelineno-0-2141"></a>
<a id="__codelineno-0-2142" name="__codelineno-0-2142"></a><span class="sd">    Resampling is done via (1) replacing each asymmetric sextet with a randomly chosen asymmetric sextet across all trees and </span>
<a id="__codelineno-0-2143" name="__codelineno-0-2143"></a><span class="sd">    (2) replacing every other cell with a randomly chosen non-asymmetric sextet cell across all trees.</span>
<a id="__codelineno-0-2144" name="__codelineno-0-2144"></a><span class="sd">    If `cell_fates` not explicitly provided, use automatically determined cell fates based on tree dataset.</span>
<a id="__codelineno-0-2145" name="__codelineno-0-2145"></a>
<a id="__codelineno-0-2146" name="__codelineno-0-2146"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2147" name="__codelineno-0-2147"></a><span class="sd">        all_trees_sorted (list): List where each entry is a string representing a tree in NEWICK format. </span>
<a id="__codelineno-0-2148" name="__codelineno-0-2148"></a><span class="sd">            Trees are sorted using the `sort_align_tree` function.</span>
<a id="__codelineno-0-2149" name="__codelineno-0-2149"></a><span class="sd">        num_resamples (int, optional): Number of resample datasets.</span>
<a id="__codelineno-0-2150" name="__codelineno-0-2150"></a><span class="sd">        replacement_bool (bool, optional): Sample cells with or without replacement drawing from the pool of all cells.</span>
<a id="__codelineno-0-2151" name="__codelineno-0-2151"></a><span class="sd">        cell_fates (string or list, optional): If &#39;auto&#39; (i.e. not provided by user), automatically determined </span>
<a id="__codelineno-0-2152" name="__codelineno-0-2152"></a><span class="sd">            based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-2153" name="__codelineno-0-2153"></a><span class="sd">        calc_expected (Boolean): Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</span>
<a id="__codelineno-0-2154" name="__codelineno-0-2154"></a>
<a id="__codelineno-0-2155" name="__codelineno-0-2155"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2156" name="__codelineno-0-2156"></a><span class="sd">        (tuple): Contains the following variables.</span>
<a id="__codelineno-0-2157" name="__codelineno-0-2157"></a><span class="sd">        - asym_septet_dict (dict): Keys are asym_septets, values are integers.</span>
<a id="__codelineno-0-2158" name="__codelineno-0-2158"></a><span class="sd">        - cell_fates (list): List where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-2159" name="__codelineno-0-2159"></a><span class="sd">        - dfs_c (DataFrame): Indexed by values from `asym_septet_dict`.</span>
<a id="__codelineno-0-2160" name="__codelineno-0-2160"></a><span class="sd">            Last column is analytically solved expected number of each asym_septet.</span>
<a id="__codelineno-0-2161" name="__codelineno-0-2161"></a><span class="sd">            Second to last column is observed number of occurences in the original dataset.</span>
<a id="__codelineno-0-2162" name="__codelineno-0-2162"></a><span class="sd">            Rest of columns are the observed number of occurences in the resampled sets.</span>
<a id="__codelineno-0-2163" name="__codelineno-0-2163"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2164" name="__codelineno-0-2164"></a>    <span class="c1"># automatically determine cell fates if not explicitly provided</span>
<a id="__codelineno-0-2165" name="__codelineno-0-2165"></a>    <span class="k">if</span> <span class="n">cell_fates</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2166" name="__codelineno-0-2166"></a>        <span class="n">cell_fates</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[A-Z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])))))</span>
<a id="__codelineno-0-2167" name="__codelineno-0-2167"></a>
<a id="__codelineno-0-2168" name="__codelineno-0-2168"></a>    <span class="c1"># _make_subtree_dict functions can only handle 10 cell fates max</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning, _make_subtree_dict functions can only handle 10 cell fates max!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a>    <span class="n">asym_septet_dict</span> <span class="o">=</span> <span class="n">_make_asym_septet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a>    <span class="n">asym_sextet_dict</span> <span class="o">=</span> <span class="n">_make_asym_sextet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a>    <span class="n">cell_dict</span> <span class="o">=</span> <span class="n">_make_cell_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>    <span class="c1"># store result for each rearrangement in dfs list</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a>    <span class="n">dfs_asym_septets_new</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a>    <span class="n">df_asym_septets_true</span> <span class="o">=</span> <span class="n">_make_df_asym_septets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">asym_septet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a>    <span class="n">df_asym_sextets_true</span> <span class="o">=</span> <span class="n">_make_df_asym_sextets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">asym_sextet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2180" name="__codelineno-0-2180"></a>    <span class="n">df_non_asym_sextets_true</span> <span class="o">=</span> <span class="n">_make_df_non_asym_sextets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">cell_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2181" name="__codelineno-0-2181"></a>
<a id="__codelineno-0-2182" name="__codelineno-0-2182"></a>    <span class="c1"># rearrange leaves num_resamples times</span>
<a id="__codelineno-0-2183" name="__codelineno-0-2183"></a>    <span class="k">for</span> <span class="n">resample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">)):</span>
<a id="__codelineno-0-2184" name="__codelineno-0-2184"></a>        <span class="n">asym_sextets_true</span> <span class="o">=</span> <span class="n">_flatten_asym_sextets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-2185" name="__codelineno-0-2185"></a>        <span class="n">non_asym_sextets_true</span> <span class="o">=</span> <span class="n">_flatten_non_asym_sextets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186"></a>
<a id="__codelineno-0-2187" name="__codelineno-0-2187"></a>        <span class="c1"># shuffle if replacement=False</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188"></a>        <span class="k">if</span> <span class="n">replacement_bool</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-2189" name="__codelineno-0-2189"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">asym_sextets_true</span><span class="p">)</span>
<a id="__codelineno-0-2190" name="__codelineno-0-2190"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">non_asym_sextets_true</span><span class="p">)</span>
<a id="__codelineno-0-2191" name="__codelineno-0-2191"></a>
<a id="__codelineno-0-2192" name="__codelineno-0-2192"></a>        <span class="c1"># first, replace the doublet with a symbol</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193"></a>        <span class="n">new_trees_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_asym_sextets_symbol</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span><span class="p">]</span>
<a id="__codelineno-0-2194" name="__codelineno-0-2194"></a>        <span class="c1"># then, replace all other cells </span>
<a id="__codelineno-0-2195" name="__codelineno-0-2195"></a>        <span class="n">new_trees_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_all</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">non_asym_sextets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_trees_1</span><span class="p">]</span>
<a id="__codelineno-0-2196" name="__codelineno-0-2196"></a>        <span class="c1"># then, replace the symbols</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197"></a>        <span class="n">new_trees_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_symbols</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">asym_sextets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_trees_2</span><span class="p">]</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198"></a>        <span class="n">df_asym_septets_new</span> <span class="o">=</span> <span class="n">_make_df_asym_septets</span><span class="p">(</span><span class="n">new_trees_3</span><span class="p">,</span> <span class="n">asym_septet_dict</span><span class="p">,</span> <span class="n">resample</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2199" name="__codelineno-0-2199"></a>        <span class="n">dfs_asym_septets_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_asym_septets_new</span><span class="p">)</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200"></a>
<a id="__codelineno-0-2201" name="__codelineno-0-2201"></a>    <span class="n">dfs_c</span> <span class="o">=</span> <span class="n">_process_dfs_asym_septet</span><span class="p">(</span><span class="n">df_asym_septets_true</span><span class="p">,</span> <span class="n">dfs_asym_septets_new</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">,</span> <span class="n">asym_septet_dict</span><span class="p">,</span> <span class="n">asym_sextet_dict</span><span class="p">,</span> <span class="n">cell_dict</span><span class="p">,</span> <span class="n">df_asym_sextets_true</span><span class="p">,</span> <span class="n">df_non_asym_sextets_true</span><span class="p">,</span> <span class="n">calc_expected</span><span class="p">)</span>
<a id="__codelineno-0-2202" name="__codelineno-0-2202"></a>
<a id="__codelineno-0-2203" name="__codelineno-0-2203"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">asym_septet_dict</span><span class="p">,</span> <span class="n">cell_fates</span><span class="p">,</span> <span class="n">dfs_c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.resample.resample_trees_asym_sextets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">resample_trees_asym_sextets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing 
number of asymmetric quintets across all resamples, the original trees, and the expected number (solved analytically).</p>
<p>Resampling is done via (1) replacing each asymmetric quintet with a randomly chosen asymmetric quintet across all trees and 
(2) replacing every other cell with a randomly chosen non-asymmetric quintet cell across all trees.
If <code>cell_fates</code> not explicitly provided, use automatically determined cell fates based on tree dataset.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>all_trees_sorted</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a string representing a tree in NEWICK format. 
Trees are sorted using the <code>sort_align_tree</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_resamples</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of resample datasets.</p></td>
          <td>
                <code>10000</code>
          </td>
        </tr>
        <tr>
          <td><code>replacement_bool</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Sample cells with or without replacement drawing from the pool of all cells.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>cell_fates</code></td>
          <td>
                <code>string or list</code>
          </td>
          <td><p>If 'auto' (i.e. not provided by user), automatically determined 
based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>calc_expected</code></td>
          <td>
                <code>Boolean</code>
          </td>
          <td><p>Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>Contains the following variables.</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>asym_sextet_dict (dict): Keys are asym_sextets, values are integers.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>cell_fates (list): List where each entry is a string representing a cell fate.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>dfs_c (DataFrame): Indexed by values from <code>asym_sextet_dict</code>.
Last column is analytically solved expected number of each asym_sextet.
Second to last column is observed number of occurences in the original dataset.
Rest of columns are the observed number of occurences in the resampled sets.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/resample.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1843" name="__codelineno-0-1843"></a><span class="k">def</span> <span class="nf">resample_trees_asym_sextets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> 
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a>                            <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> 
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a>                            <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a>                            <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a>                            <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a>                           <span class="p">):</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing </span>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a><span class="sd">    number of asymmetric quintets across all resamples, the original trees, and the expected number (solved analytically).</span>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a><span class="sd">    Resampling is done via (1) replacing each asymmetric quintet with a randomly chosen asymmetric quintet across all trees and </span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a><span class="sd">    (2) replacing every other cell with a randomly chosen non-asymmetric quintet cell across all trees.</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a><span class="sd">    If `cell_fates` not explicitly provided, use automatically determined cell fates based on tree dataset.</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a><span class="sd">        all_trees_sorted (list): List where each entry is a string representing a tree in NEWICK format. </span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a><span class="sd">            Trees are sorted using the `sort_align_tree` function.</span>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a><span class="sd">        num_resamples (int, optional): Number of resample datasets.</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a><span class="sd">        replacement_bool (bool, optional): Sample cells with or without replacement drawing from the pool of all cells.</span>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a><span class="sd">        cell_fates (string or list, optional): If &#39;auto&#39; (i.e. not provided by user), automatically determined </span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a><span class="sd">            based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a><span class="sd">        calc_expected (Boolean): Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a><span class="sd">        (tuple): Contains the following variables.</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a><span class="sd">        - asym_sextet_dict (dict): Keys are asym_sextets, values are integers.</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a><span class="sd">        - cell_fates (list): List where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a><span class="sd">        - dfs_c (DataFrame): Indexed by values from `asym_sextet_dict`.</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a><span class="sd">            Last column is analytically solved expected number of each asym_sextet.</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a><span class="sd">            Second to last column is observed number of occurences in the original dataset.</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a><span class="sd">            Rest of columns are the observed number of occurences in the resampled sets.</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a>    <span class="c1"># automatically determine cell fates if not explicitly provided</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a>    <span class="k">if</span> <span class="n">cell_fates</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>        <span class="n">cell_fates</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[A-Z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])))))</span>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a>    <span class="c1"># _make_subtree_dict functions can only handle 10 cell fates max</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning, _make_subtree_dict functions can only handle 10 cell fates max!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a>    <span class="n">asym_sextet_dict</span> <span class="o">=</span> <span class="n">_make_asym_sextet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a>    <span class="n">asym_quintet_dict</span> <span class="o">=</span> <span class="n">_make_asym_quintet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a>    <span class="n">cell_dict</span> <span class="o">=</span> <span class="n">_make_cell_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a>    <span class="c1"># store result for each rearrangement in dfs list</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a>    <span class="n">dfs_asym_sextets_new</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a>    <span class="n">df_asym_sextets_true</span> <span class="o">=</span> <span class="n">_make_df_asym_sextets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">asym_sextet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a>    <span class="n">df_asym_quintets_true</span> <span class="o">=</span> <span class="n">_make_df_asym_quintets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">asym_quintet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a>    <span class="n">df_non_asym_quintets_true</span> <span class="o">=</span> <span class="n">_make_df_non_asym_quintets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">cell_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a>    <span class="c1"># rearrange leaves num_resamples times</span>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a>    <span class="k">for</span> <span class="n">resample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">)):</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a>        <span class="n">asym_quintets_true</span> <span class="o">=</span> <span class="n">_flatten_asym_quintets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a>        <span class="n">non_asym_quintets_true</span> <span class="o">=</span> <span class="n">_flatten_non_asym_quintets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a>        <span class="c1"># shuffle if replacement=False</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a>        <span class="k">if</span> <span class="n">replacement_bool</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">asym_quintets_true</span><span class="p">)</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">non_asym_quintets_true</span><span class="p">)</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a>        <span class="c1"># first, replace the doublet with a symbol</span>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a>        <span class="n">new_trees_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_asym_quintets_symbol</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span><span class="p">]</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a>        <span class="c1"># then, replace all other cells </span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a>        <span class="n">new_trees_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_all</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">non_asym_quintets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_trees_1</span><span class="p">]</span>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a>        <span class="c1"># then, replace the symbols</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a>        <span class="n">new_trees_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_symbols</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">asym_quintets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_trees_2</span><span class="p">]</span>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>        <span class="n">df_asym_sextets_new</span> <span class="o">=</span> <span class="n">_make_df_asym_sextets</span><span class="p">(</span><span class="n">new_trees_3</span><span class="p">,</span> <span class="n">asym_sextet_dict</span><span class="p">,</span> <span class="n">resample</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a>        <span class="n">dfs_asym_sextets_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_asym_sextets_new</span><span class="p">)</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a>    <span class="n">dfs_c</span> <span class="o">=</span> <span class="n">_process_dfs_asym_sextet</span><span class="p">(</span><span class="n">df_asym_sextets_true</span><span class="p">,</span> <span class="n">dfs_asym_sextets_new</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">,</span> <span class="n">asym_sextet_dict</span><span class="p">,</span> <span class="n">asym_quintet_dict</span><span class="p">,</span> <span class="n">cell_dict</span><span class="p">,</span> <span class="n">df_asym_quintets_true</span><span class="p">,</span> <span class="n">df_non_asym_quintets_true</span><span class="p">,</span> <span class="n">calc_expected</span><span class="p">)</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">asym_sextet_dict</span><span class="p">,</span> <span class="n">cell_fates</span><span class="p">,</span> <span class="n">dfs_c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.resample.resample_trees_doublets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">resample_trees_doublets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Performs resampling of trees, drawing with or without replacement, returning subtree dictionary and DataFrame containing
number of doublets across all resamples, the original trees, and the expected number (solved analytically).</p>
<p>Resampling is done by replacing each cell fate with a randomly chosen cell fate across all trees.
If <code>cell_fates</code> not explicitly provided, use automatically determined cell fates based on tree dataset.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>all_trees_sorted</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a string representing a tree in NEWICK format. 
Trees are sorted using the <code>sort_align_tree</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_resamples</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of resample datasets.</p></td>
          <td>
                <code>10000</code>
          </td>
        </tr>
        <tr>
          <td><code>replacement_bool</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Sample cells with or without replacement drawing from the pool of all cells.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>cell_fates</code></td>
          <td>
                <code>string or list</code>
          </td>
          <td><p>If 'auto' (i.e. not provided by user), automatically determined 
based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>calc_expected</code></td>
          <td>
                <code>Boolean</code>
          </td>
          <td><p>Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>Contains the following variables.</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>doublet_dict (dict): Keys are doublets, values are integers.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>cell_fates (list): List where each entry is a string representing a cell fate.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>dfs_c (DataFrame): Indexed by values from <code>doublet_dict</code>.
Last column is analytically solved expected number of each doublet.
Second to last column is observed number of occurences in the original dataset.
Rest of columns are the observed number of occurences in the resampled sets.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/resample.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="k">def</span> <span class="nf">resample_trees_doublets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> 
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                            <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> 
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>                            <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                            <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                            <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                            <span class="p">):</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs resampling of trees, drawing with or without replacement, returning subtree dictionary and DataFrame containing</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">    number of doublets across all resamples, the original trees, and the expected number (solved analytically).</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">    Resampling is done by replacing each cell fate with a randomly chosen cell fate across all trees.</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">    If `cell_fates` not explicitly provided, use automatically determined cell fates based on tree dataset.</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        all_trees_sorted (list): List where each entry is a string representing a tree in NEWICK format. </span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">            Trees are sorted using the `sort_align_tree` function.</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">        num_resamples (int, optional): Number of resample datasets.</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        replacement_bool (bool, optional): Sample cells with or without replacement drawing from the pool of all cells.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">        cell_fates (string or list, optional): If &#39;auto&#39; (i.e. not provided by user), automatically determined </span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">            based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        calc_expected (Boolean): Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">        (tuple): Contains the following variables.</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">        - doublet_dict (dict): Keys are doublets, values are integers.</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">        - cell_fates (list): List where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">        - dfs_c (DataFrame): Indexed by values from `doublet_dict`.</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">            Last column is analytically solved expected number of each doublet.</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">            Second to last column is observed number of occurences in the original dataset.</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">            Rest of columns are the observed number of occurences in the resampled sets.</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="c1"># automatically determine cell fates if not explicitly provided</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="k">if</span> <span class="n">cell_fates</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="n">cell_fates</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[A-Z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])))))</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="c1"># _make_subtree_dict functions can only handle 10 cell fates max</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="n">doublet_dict</span> <span class="o">=</span> <span class="n">_make_doublet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="n">cell_dict</span> <span class="o">=</span> <span class="n">_make_cell_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="c1"># store result for each rearrangement in dfs list</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="n">dfs_doublets_new</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>    <span class="n">df_doublets_true</span> <span class="o">=</span> <span class="n">_make_df_doublets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">doublet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="n">df_all_cells_true</span> <span class="o">=</span> <span class="n">_make_df_all_cells</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">cell_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="c1"># rearrange leaves num_resamples times</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="k">for</span> <span class="n">resample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">)):</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="n">all_cells_true</span> <span class="o">=</span> <span class="n">_flatten_all_cells</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="c1"># shuffle if replacement=False</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="k">if</span> <span class="n">replacement_bool</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">all_cells_true</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="n">new_trees</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_all</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">all_cells_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span><span class="p">]</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="n">df_doublets_new</span> <span class="o">=</span> <span class="n">_make_df_doublets</span><span class="p">(</span><span class="n">new_trees</span><span class="p">,</span> <span class="n">doublet_dict</span><span class="p">,</span> <span class="n">resample</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="n">dfs_doublets_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_doublets_new</span><span class="p">)</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>    <span class="n">dfs_c</span> <span class="o">=</span> <span class="n">_process_dfs_doublet</span><span class="p">(</span><span class="n">df_doublets_true</span><span class="p">,</span> <span class="n">dfs_doublets_new</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">,</span> <span class="n">doublet_dict</span><span class="p">,</span> <span class="n">cell_dict</span><span class="p">,</span> <span class="n">df_all_cells_true</span><span class="p">,</span> <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">doublet_dict</span><span class="p">,</span> <span class="n">cell_fates</span><span class="p">,</span> <span class="n">dfs_c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.resample.resample_trees_octets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">resample_trees_octets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing 
the number of octets across all resamples, the original trees, and the expected number (solved analytically).</p>
<p>Resampling is done via replacing each quartet with a randomly chosen quartet from across all trees.
If <code>cell_fates</code> not explicitly provided, use automatically determined cell fates based on tree dataset.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>all_trees_sorted</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a string representing a tree in NEWICK format. 
Trees are sorted using the <code>sort_align_tree</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_resamples</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of resample datasets.</p></td>
          <td>
                <code>10000</code>
          </td>
        </tr>
        <tr>
          <td><code>replacement_bool</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Sample cells with or without replacement drawing from the pool of all cells.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>cell_fates</code></td>
          <td>
                <code>string or list</code>
          </td>
          <td><p>If 'auto' (i.e. not provided by user), automatically determined 
based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>calc_expected</code></td>
          <td>
                <code>Boolean</code>
          </td>
          <td><p>Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>Contains the following variables.</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>octet_dict (dict): Keys are octets, values are integers.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>cell_fates (list): List where each entry is a string representing a cell fate.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>dfs_c (DataFrame): Indexed by values from <code>octet_dict</code>.
Last column is analytically solved expected number of each octet.
Second to last column is observed number of occurences in the original dataset.
Rest of columns are the observed number of occurences in the resampled sets.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/resample.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2656">2656</a></span>
<span class="normal"><a href="#__codelineno-0-2657">2657</a></span>
<span class="normal"><a href="#__codelineno-0-2658">2658</a></span>
<span class="normal"><a href="#__codelineno-0-2659">2659</a></span>
<span class="normal"><a href="#__codelineno-0-2660">2660</a></span>
<span class="normal"><a href="#__codelineno-0-2661">2661</a></span>
<span class="normal"><a href="#__codelineno-0-2662">2662</a></span>
<span class="normal"><a href="#__codelineno-0-2663">2663</a></span>
<span class="normal"><a href="#__codelineno-0-2664">2664</a></span>
<span class="normal"><a href="#__codelineno-0-2665">2665</a></span>
<span class="normal"><a href="#__codelineno-0-2666">2666</a></span>
<span class="normal"><a href="#__codelineno-0-2667">2667</a></span>
<span class="normal"><a href="#__codelineno-0-2668">2668</a></span>
<span class="normal"><a href="#__codelineno-0-2669">2669</a></span>
<span class="normal"><a href="#__codelineno-0-2670">2670</a></span>
<span class="normal"><a href="#__codelineno-0-2671">2671</a></span>
<span class="normal"><a href="#__codelineno-0-2672">2672</a></span>
<span class="normal"><a href="#__codelineno-0-2673">2673</a></span>
<span class="normal"><a href="#__codelineno-0-2674">2674</a></span>
<span class="normal"><a href="#__codelineno-0-2675">2675</a></span>
<span class="normal"><a href="#__codelineno-0-2676">2676</a></span>
<span class="normal"><a href="#__codelineno-0-2677">2677</a></span>
<span class="normal"><a href="#__codelineno-0-2678">2678</a></span>
<span class="normal"><a href="#__codelineno-0-2679">2679</a></span>
<span class="normal"><a href="#__codelineno-0-2680">2680</a></span>
<span class="normal"><a href="#__codelineno-0-2681">2681</a></span>
<span class="normal"><a href="#__codelineno-0-2682">2682</a></span>
<span class="normal"><a href="#__codelineno-0-2683">2683</a></span>
<span class="normal"><a href="#__codelineno-0-2684">2684</a></span>
<span class="normal"><a href="#__codelineno-0-2685">2685</a></span>
<span class="normal"><a href="#__codelineno-0-2686">2686</a></span>
<span class="normal"><a href="#__codelineno-0-2687">2687</a></span>
<span class="normal"><a href="#__codelineno-0-2688">2688</a></span>
<span class="normal"><a href="#__codelineno-0-2689">2689</a></span>
<span class="normal"><a href="#__codelineno-0-2690">2690</a></span>
<span class="normal"><a href="#__codelineno-0-2691">2691</a></span>
<span class="normal"><a href="#__codelineno-0-2692">2692</a></span>
<span class="normal"><a href="#__codelineno-0-2693">2693</a></span>
<span class="normal"><a href="#__codelineno-0-2694">2694</a></span>
<span class="normal"><a href="#__codelineno-0-2695">2695</a></span>
<span class="normal"><a href="#__codelineno-0-2696">2696</a></span>
<span class="normal"><a href="#__codelineno-0-2697">2697</a></span>
<span class="normal"><a href="#__codelineno-0-2698">2698</a></span>
<span class="normal"><a href="#__codelineno-0-2699">2699</a></span>
<span class="normal"><a href="#__codelineno-0-2700">2700</a></span>
<span class="normal"><a href="#__codelineno-0-2701">2701</a></span>
<span class="normal"><a href="#__codelineno-0-2702">2702</a></span>
<span class="normal"><a href="#__codelineno-0-2703">2703</a></span>
<span class="normal"><a href="#__codelineno-0-2704">2704</a></span>
<span class="normal"><a href="#__codelineno-0-2705">2705</a></span>
<span class="normal"><a href="#__codelineno-0-2706">2706</a></span>
<span class="normal"><a href="#__codelineno-0-2707">2707</a></span>
<span class="normal"><a href="#__codelineno-0-2708">2708</a></span>
<span class="normal"><a href="#__codelineno-0-2709">2709</a></span>
<span class="normal"><a href="#__codelineno-0-2710">2710</a></span>
<span class="normal"><a href="#__codelineno-0-2711">2711</a></span>
<span class="normal"><a href="#__codelineno-0-2712">2712</a></span>
<span class="normal"><a href="#__codelineno-0-2713">2713</a></span>
<span class="normal"><a href="#__codelineno-0-2714">2714</a></span>
<span class="normal"><a href="#__codelineno-0-2715">2715</a></span>
<span class="normal"><a href="#__codelineno-0-2716">2716</a></span>
<span class="normal"><a href="#__codelineno-0-2717">2717</a></span>
<span class="normal"><a href="#__codelineno-0-2718">2718</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2656" name="__codelineno-0-2656"></a><span class="k">def</span> <span class="nf">resample_trees_octets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> 
<a id="__codelineno-0-2657" name="__codelineno-0-2657"></a>                            <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> 
<a id="__codelineno-0-2658" name="__codelineno-0-2658"></a>                            <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2659" name="__codelineno-0-2659"></a>                            <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-2660" name="__codelineno-0-2660"></a>                            <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-2661" name="__codelineno-0-2661"></a>                           <span class="p">):</span>
<a id="__codelineno-0-2662" name="__codelineno-0-2662"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing </span>
<a id="__codelineno-0-2663" name="__codelineno-0-2663"></a><span class="sd">    the number of octets across all resamples, the original trees, and the expected number (solved analytically).</span>
<a id="__codelineno-0-2664" name="__codelineno-0-2664"></a>
<a id="__codelineno-0-2665" name="__codelineno-0-2665"></a><span class="sd">    Resampling is done via replacing each quartet with a randomly chosen quartet from across all trees.</span>
<a id="__codelineno-0-2666" name="__codelineno-0-2666"></a><span class="sd">    If `cell_fates` not explicitly provided, use automatically determined cell fates based on tree dataset.</span>
<a id="__codelineno-0-2667" name="__codelineno-0-2667"></a>
<a id="__codelineno-0-2668" name="__codelineno-0-2668"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2669" name="__codelineno-0-2669"></a><span class="sd">        all_trees_sorted (list): List where each entry is a string representing a tree in NEWICK format. </span>
<a id="__codelineno-0-2670" name="__codelineno-0-2670"></a><span class="sd">            Trees are sorted using the `sort_align_tree` function.</span>
<a id="__codelineno-0-2671" name="__codelineno-0-2671"></a><span class="sd">        num_resamples (int, optional): Number of resample datasets.</span>
<a id="__codelineno-0-2672" name="__codelineno-0-2672"></a><span class="sd">        replacement_bool (bool, optional): Sample cells with or without replacement drawing from the pool of all cells.</span>
<a id="__codelineno-0-2673" name="__codelineno-0-2673"></a><span class="sd">        cell_fates (string or list, optional): If &#39;auto&#39; (i.e. not provided by user), automatically determined </span>
<a id="__codelineno-0-2674" name="__codelineno-0-2674"></a><span class="sd">            based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-2675" name="__codelineno-0-2675"></a><span class="sd">        calc_expected (Boolean): Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</span>
<a id="__codelineno-0-2676" name="__codelineno-0-2676"></a>
<a id="__codelineno-0-2677" name="__codelineno-0-2677"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2678" name="__codelineno-0-2678"></a><span class="sd">        (tuple): Contains the following variables.</span>
<a id="__codelineno-0-2679" name="__codelineno-0-2679"></a><span class="sd">        - octet_dict (dict): Keys are octets, values are integers.</span>
<a id="__codelineno-0-2680" name="__codelineno-0-2680"></a><span class="sd">        - cell_fates (list): List where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-2681" name="__codelineno-0-2681"></a><span class="sd">        - dfs_c (DataFrame): Indexed by values from `octet_dict`.</span>
<a id="__codelineno-0-2682" name="__codelineno-0-2682"></a><span class="sd">            Last column is analytically solved expected number of each octet.</span>
<a id="__codelineno-0-2683" name="__codelineno-0-2683"></a><span class="sd">            Second to last column is observed number of occurences in the original dataset.</span>
<a id="__codelineno-0-2684" name="__codelineno-0-2684"></a><span class="sd">            Rest of columns are the observed number of occurences in the resampled sets.</span>
<a id="__codelineno-0-2685" name="__codelineno-0-2685"></a>
<a id="__codelineno-0-2686" name="__codelineno-0-2686"></a>
<a id="__codelineno-0-2687" name="__codelineno-0-2687"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2688" name="__codelineno-0-2688"></a>    <span class="c1"># automatically determine cell fates if not explicitly provided</span>
<a id="__codelineno-0-2689" name="__codelineno-0-2689"></a>    <span class="k">if</span> <span class="n">cell_fates</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2690" name="__codelineno-0-2690"></a>        <span class="n">cell_fates</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[A-Z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])))))</span>
<a id="__codelineno-0-2691" name="__codelineno-0-2691"></a>
<a id="__codelineno-0-2692" name="__codelineno-0-2692"></a>    <span class="c1"># _make_subtree_dict functions can only handle 10 cell fates max</span>
<a id="__codelineno-0-2693" name="__codelineno-0-2693"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-2694" name="__codelineno-0-2694"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2695" name="__codelineno-0-2695"></a>
<a id="__codelineno-0-2696" name="__codelineno-0-2696"></a>    <span class="n">octet_dict</span> <span class="o">=</span> <span class="n">_make_octet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-2697" name="__codelineno-0-2697"></a>    <span class="n">quartet_dict</span> <span class="o">=</span> <span class="n">_make_quartet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-2698" name="__codelineno-0-2698"></a>
<a id="__codelineno-0-2699" name="__codelineno-0-2699"></a>    <span class="c1"># store result for each rearrangement in dfs list</span>
<a id="__codelineno-0-2700" name="__codelineno-0-2700"></a>    <span class="n">dfs_octets_new</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2701" name="__codelineno-0-2701"></a>    <span class="n">df_octets_true</span> <span class="o">=</span> <span class="n">_make_df_octets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">octet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2702" name="__codelineno-0-2702"></a>    <span class="n">df_quartets_true</span> <span class="o">=</span> <span class="n">_make_df_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">quartet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2703" name="__codelineno-0-2703"></a>
<a id="__codelineno-0-2704" name="__codelineno-0-2704"></a>    <span class="c1"># rearrange leaves num_resamples times</span>
<a id="__codelineno-0-2705" name="__codelineno-0-2705"></a>    <span class="k">for</span> <span class="n">resample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">)):</span>
<a id="__codelineno-0-2706" name="__codelineno-0-2706"></a>        <span class="n">quartets_true</span> <span class="o">=</span> <span class="n">_flatten_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-2707" name="__codelineno-0-2707"></a>
<a id="__codelineno-0-2708" name="__codelineno-0-2708"></a>        <span class="c1"># shuffle if replacement=False</span>
<a id="__codelineno-0-2709" name="__codelineno-0-2709"></a>        <span class="k">if</span> <span class="n">replacement_bool</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-2710" name="__codelineno-0-2710"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">quartets_true</span><span class="p">)</span>
<a id="__codelineno-0-2711" name="__codelineno-0-2711"></a>
<a id="__codelineno-0-2712" name="__codelineno-0-2712"></a>        <span class="n">new_trees</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_quartets</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">quartets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span><span class="p">]</span>
<a id="__codelineno-0-2713" name="__codelineno-0-2713"></a>        <span class="n">df_octets_new</span> <span class="o">=</span> <span class="n">_make_df_octets</span><span class="p">(</span><span class="n">new_trees</span><span class="p">,</span> <span class="n">octet_dict</span><span class="p">,</span> <span class="n">resample</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2714" name="__codelineno-0-2714"></a>        <span class="n">dfs_octets_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_octets_new</span><span class="p">)</span>
<a id="__codelineno-0-2715" name="__codelineno-0-2715"></a>
<a id="__codelineno-0-2716" name="__codelineno-0-2716"></a>    <span class="n">dfs_c</span> <span class="o">=</span> <span class="n">_process_dfs_octet</span><span class="p">(</span><span class="n">df_octets_true</span><span class="p">,</span> <span class="n">dfs_octets_new</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">,</span> <span class="n">octet_dict</span><span class="p">,</span> <span class="n">quartet_dict</span><span class="p">,</span> <span class="n">df_quartets_true</span><span class="p">,</span> <span class="n">calc_expected</span><span class="p">)</span>
<a id="__codelineno-0-2717" name="__codelineno-0-2717"></a>
<a id="__codelineno-0-2718" name="__codelineno-0-2718"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">octet_dict</span><span class="p">,</span> <span class="n">cell_fates</span><span class="p">,</span> <span class="n">dfs_c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.resample.resample_trees_quartets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">resample_trees_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing 
the number of quartets across all resamples, the original trees, and the expected number (solved analytically).</p>
<p>Resampling is done via replacing each doublet with a randomly chosen doublet from across all trees.
If <code>cell_fates</code> not explicitly provided, use automatically determined cell fates based on tree dataset.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>all_trees_sorted</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a string representing a tree in NEWICK format. 
Trees are sorted using the <code>sort_align_tree</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_resamples</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of resample datasets.</p></td>
          <td>
                <code>10000</code>
          </td>
        </tr>
        <tr>
          <td><code>replacement_bool</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Sample cells with or without replacement drawing from the pool of all cells.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>cell_fates</code></td>
          <td>
                <code>string or list</code>
          </td>
          <td><p>If 'auto' (i.e. not provided by user), automatically determined 
based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>calc_expected</code></td>
          <td>
                <code>Boolean</code>
          </td>
          <td><p>Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>Contains the following variables.</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>quartet_dict (dict): Keys are quartets, values are integers.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>cell_fates (list): List where each entry is a string representing a cell fate.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>dfs_c (DataFrame): Indexed by values from <code>quartet_dict</code>.
Last column is analytically solved expected number of each quartet.
Second to last column is observed number of occurences in the original dataset.
Rest of columns are the observed number of occurences in the resampled sets.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/resample.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="k">def</span> <span class="nf">resample_trees_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> 
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>                            <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> 
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>                            <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>                            <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>                            <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>                           <span class="p">):</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing </span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">    the number of quartets across all resamples, the original trees, and the expected number (solved analytically).</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">    Resampling is done via replacing each doublet with a randomly chosen doublet from across all trees.</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">    If `cell_fates` not explicitly provided, use automatically determined cell fates based on tree dataset.</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">        all_trees_sorted (list): List where each entry is a string representing a tree in NEWICK format. </span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">            Trees are sorted using the `sort_align_tree` function.</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><span class="sd">        num_resamples (int, optional): Number of resample datasets.</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">        replacement_bool (bool, optional): Sample cells with or without replacement drawing from the pool of all cells.</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><span class="sd">        cell_fates (string or list, optional): If &#39;auto&#39; (i.e. not provided by user), automatically determined </span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">            based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><span class="sd">        calc_expected (Boolean): Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">        (tuple): Contains the following variables.</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><span class="sd">        - quartet_dict (dict): Keys are quartets, values are integers.</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a><span class="sd">        - cell_fates (list): List where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">        - dfs_c (DataFrame): Indexed by values from `quartet_dict`.</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><span class="sd">            Last column is analytically solved expected number of each quartet.</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">            Second to last column is observed number of occurences in the original dataset.</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">            Rest of columns are the observed number of occurences in the resampled sets.</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>    <span class="c1"># automatically determine cell fates if not explicitly provided</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>    <span class="k">if</span> <span class="n">cell_fates</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>        <span class="n">cell_fates</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[A-Z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])))))</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>    <span class="c1"># _make_subtree_dict functions can only handle 10 cell fates max</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>    <span class="n">quartet_dict</span> <span class="o">=</span> <span class="n">_make_quartet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>    <span class="n">doublet_dict</span> <span class="o">=</span> <span class="n">_make_doublet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>    <span class="c1"># store result for each rearrangement in dfs list</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>    <span class="n">dfs_quartets_new</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>    <span class="n">df_quartets_true</span> <span class="o">=</span> <span class="n">_make_df_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">quartet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>    <span class="n">df_doublets_true</span> <span class="o">=</span> <span class="n">_make_df_doublets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">doublet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>    <span class="c1"># rearrange leaves num_resamples times</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>    <span class="k">for</span> <span class="n">resample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">)):</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>        <span class="n">doublets_true</span> <span class="o">=</span> <span class="n">_flatten_doublets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>        <span class="c1"># shuffle if replacement=False</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>        <span class="k">if</span> <span class="n">replacement_bool</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">doublets_true</span><span class="p">)</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>        <span class="n">new_trees</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_doublets</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">doublets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span><span class="p">]</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>        <span class="n">df_quartets_new</span> <span class="o">=</span> <span class="n">_make_df_quartets</span><span class="p">(</span><span class="n">new_trees</span><span class="p">,</span> <span class="n">quartet_dict</span><span class="p">,</span> <span class="n">resample</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>        <span class="n">dfs_quartets_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_quartets_new</span><span class="p">)</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>    <span class="n">dfs_c</span> <span class="o">=</span> <span class="n">_process_dfs_quartet</span><span class="p">(</span><span class="n">df_quartets_true</span><span class="p">,</span> <span class="n">dfs_quartets_new</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">,</span> <span class="n">quartet_dict</span><span class="p">,</span> <span class="n">doublet_dict</span><span class="p">,</span> <span class="n">df_doublets_true</span><span class="p">,</span> <span class="n">calc_expected</span><span class="p">)</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">quartet_dict</span><span class="p">,</span> <span class="n">cell_fates</span><span class="p">,</span> <span class="n">dfs_c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.resample.resample_trees_sextets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">resample_trees_sextets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing 
number of sextets across all resamples, the original trees, and the expected number (solved analytically).</p>
<p>Resampling is done via (1) replacing each quartet with a randomly chosen quartet across all trees and 
(2) replacing every other doublet with a randomly chosen non-quartet doublet across all trees.
If <code>cell_fates</code> not explicitly provided, use automatically determined cell fates based on tree dataset.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>all_trees_sorted</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a string representing a tree in NEWICK format. 
Trees are sorted using the <code>sort_align_tree</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_resamples</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of resample datasets.</p></td>
          <td>
                <code>10000</code>
          </td>
        </tr>
        <tr>
          <td><code>replacement_bool</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Sample cells with or without replacement drawing from the pool of all cells.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>cell_fates</code></td>
          <td>
                <code>string or list</code>
          </td>
          <td><p>If 'auto' (i.e. not provided by user), automatically determined 
based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>calc_expected</code></td>
          <td>
                <code>Boolean</code>
          </td>
          <td><p>Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>Contains the following variables.</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>sextet_dict (dict): Keys are sextets, values are integers.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>cell_fates (list): List where each entry is a string representing a cell fate.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>dfs_c (DataFrame): Indexed by values from <code>sextet_dict</code>.
Last column is analytically solved expected number of each sextet.
Second to last column is observed number of occurences in the original dataset.
Rest of columns are the observed number of occurences in the resampled sets.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/resample.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2419" name="__codelineno-0-2419"></a><span class="k">def</span> <span class="nf">resample_trees_sextets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> 
<a id="__codelineno-0-2420" name="__codelineno-0-2420"></a>                            <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> 
<a id="__codelineno-0-2421" name="__codelineno-0-2421"></a>                            <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2422" name="__codelineno-0-2422"></a>                            <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-2423" name="__codelineno-0-2423"></a>                            <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-2424" name="__codelineno-0-2424"></a>                           <span class="p">):</span>
<a id="__codelineno-0-2425" name="__codelineno-0-2425"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing </span>
<a id="__codelineno-0-2426" name="__codelineno-0-2426"></a><span class="sd">    number of sextets across all resamples, the original trees, and the expected number (solved analytically).</span>
<a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>
<a id="__codelineno-0-2428" name="__codelineno-0-2428"></a><span class="sd">    Resampling is done via (1) replacing each quartet with a randomly chosen quartet across all trees and </span>
<a id="__codelineno-0-2429" name="__codelineno-0-2429"></a><span class="sd">    (2) replacing every other doublet with a randomly chosen non-quartet doublet across all trees.</span>
<a id="__codelineno-0-2430" name="__codelineno-0-2430"></a><span class="sd">    If `cell_fates` not explicitly provided, use automatically determined cell fates based on tree dataset.</span>
<a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>
<a id="__codelineno-0-2432" name="__codelineno-0-2432"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2433" name="__codelineno-0-2433"></a><span class="sd">        all_trees_sorted (list): List where each entry is a string representing a tree in NEWICK format. </span>
<a id="__codelineno-0-2434" name="__codelineno-0-2434"></a><span class="sd">            Trees are sorted using the `sort_align_tree` function.</span>
<a id="__codelineno-0-2435" name="__codelineno-0-2435"></a><span class="sd">        num_resamples (int, optional): Number of resample datasets.</span>
<a id="__codelineno-0-2436" name="__codelineno-0-2436"></a><span class="sd">        replacement_bool (bool, optional): Sample cells with or without replacement drawing from the pool of all cells.</span>
<a id="__codelineno-0-2437" name="__codelineno-0-2437"></a><span class="sd">        cell_fates (string or list, optional): If &#39;auto&#39; (i.e. not provided by user), automatically determined </span>
<a id="__codelineno-0-2438" name="__codelineno-0-2438"></a><span class="sd">            based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-2439" name="__codelineno-0-2439"></a><span class="sd">        calc_expected (Boolean): Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</span>
<a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>
<a id="__codelineno-0-2441" name="__codelineno-0-2441"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2442" name="__codelineno-0-2442"></a><span class="sd">        (tuple): Contains the following variables.</span>
<a id="__codelineno-0-2443" name="__codelineno-0-2443"></a><span class="sd">        - sextet_dict (dict): Keys are sextets, values are integers.</span>
<a id="__codelineno-0-2444" name="__codelineno-0-2444"></a><span class="sd">        - cell_fates (list): List where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-2445" name="__codelineno-0-2445"></a><span class="sd">        - dfs_c (DataFrame): Indexed by values from `sextet_dict`.</span>
<a id="__codelineno-0-2446" name="__codelineno-0-2446"></a><span class="sd">            Last column is analytically solved expected number of each sextet.</span>
<a id="__codelineno-0-2447" name="__codelineno-0-2447"></a><span class="sd">            Second to last column is observed number of occurences in the original dataset.</span>
<a id="__codelineno-0-2448" name="__codelineno-0-2448"></a><span class="sd">            Rest of columns are the observed number of occurences in the resampled sets.</span>
<a id="__codelineno-0-2449" name="__codelineno-0-2449"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>    <span class="c1"># automatically determine cell fates if not explicitly provided</span>
<a id="__codelineno-0-2451" name="__codelineno-0-2451"></a>    <span class="k">if</span> <span class="n">cell_fates</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2452" name="__codelineno-0-2452"></a>        <span class="n">cell_fates</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[A-Z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])))))</span>
<a id="__codelineno-0-2453" name="__codelineno-0-2453"></a>
<a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>    <span class="c1"># _make_subtree_dict functions can only handle 10 cell fates max</span>
<a id="__codelineno-0-2455" name="__codelineno-0-2455"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-2456" name="__codelineno-0-2456"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2457" name="__codelineno-0-2457"></a>
<a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>    <span class="n">sextet_dict</span> <span class="o">=</span> <span class="n">_make_sextet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-2459" name="__codelineno-0-2459"></a>    <span class="n">quartet_dict</span> <span class="o">=</span> <span class="n">_make_quartet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-2460" name="__codelineno-0-2460"></a>    <span class="n">doublet_dict</span> <span class="o">=</span> <span class="n">_make_doublet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-2461" name="__codelineno-0-2461"></a>
<a id="__codelineno-0-2462" name="__codelineno-0-2462"></a>    <span class="c1"># store result for each rearrangement in dfs list</span>
<a id="__codelineno-0-2463" name="__codelineno-0-2463"></a>    <span class="n">dfs_sextets_new</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2464" name="__codelineno-0-2464"></a>    <span class="n">df_sextets_true</span> <span class="o">=</span> <span class="n">_make_df_sextets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">sextet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2465" name="__codelineno-0-2465"></a>    <span class="n">df_quartets_true</span> <span class="o">=</span> <span class="n">_make_df_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">quartet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>    <span class="n">df_doublets_non_quartets_true</span> <span class="o">=</span> <span class="n">_make_df_doublets_non_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">doublet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>
<a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>    <span class="c1"># rearrange leaves num_resamples times</span>
<a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>    <span class="k">for</span> <span class="n">resample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">)):</span>
<a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>        <span class="n">quartets_true</span> <span class="o">=</span> <span class="n">_flatten_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>        <span class="n">doublets_non_quartets_true</span> <span class="o">=</span> <span class="n">_flatten_doublets_non_quartets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>
<a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>        <span class="c1"># shuffle if replacement=False</span>
<a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>        <span class="k">if</span> <span class="n">replacement_bool</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">quartets_true</span><span class="p">)</span>
<a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">doublets_non_quartets_true</span><span class="p">)</span>
<a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>
<a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>        <span class="c1"># first, replace the doublet with a symbol</span>
<a id="__codelineno-0-2479" name="__codelineno-0-2479"></a>        <span class="n">new_trees_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_quartets_symbol</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span><span class="p">]</span>
<a id="__codelineno-0-2480" name="__codelineno-0-2480"></a>        <span class="c1"># then, replace all other cells </span>
<a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>        <span class="n">new_trees_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_doublets</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">doublets_non_quartets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_trees_1</span><span class="p">]</span>
<a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>        <span class="c1"># then, replace the symbols</span>
<a id="__codelineno-0-2483" name="__codelineno-0-2483"></a>        <span class="n">new_trees_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_symbols</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">quartets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_trees_2</span><span class="p">]</span>
<a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>        <span class="n">df_sextets_new</span> <span class="o">=</span> <span class="n">_make_df_sextets</span><span class="p">(</span><span class="n">new_trees_3</span><span class="p">,</span> <span class="n">sextet_dict</span><span class="p">,</span> <span class="n">resample</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>        <span class="n">dfs_sextets_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_sextets_new</span><span class="p">)</span>
<a id="__codelineno-0-2486" name="__codelineno-0-2486"></a>
<a id="__codelineno-0-2487" name="__codelineno-0-2487"></a>    <span class="n">dfs_c</span> <span class="o">=</span> <span class="n">_process_dfs_sextet</span><span class="p">(</span><span class="n">df_sextets_true</span><span class="p">,</span> <span class="n">dfs_sextets_new</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">,</span> <span class="n">sextet_dict</span><span class="p">,</span> <span class="n">quartet_dict</span><span class="p">,</span> <span class="n">doublet_dict</span><span class="p">,</span> <span class="n">df_quartets_true</span><span class="p">,</span> <span class="n">df_doublets_non_quartets_true</span><span class="p">,</span> <span class="n">calc_expected</span><span class="p">)</span>
<a id="__codelineno-0-2488" name="__codelineno-0-2488"></a>
<a id="__codelineno-0-2489" name="__codelineno-0-2489"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">sextet_dict</span><span class="p">,</span> <span class="n">cell_fates</span><span class="p">,</span> <span class="n">dfs_c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.resample.resample_trees_triplets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">resample_trees_triplets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing 
number of triplets across all resamples, the original trees, and the expected number (solved analytically).</p>
<p>Resampling is done via (1) replacing each cell with a randomly chosen non_doublet across all trees and 
(2) replacing each doublet with a randomly chosen doublet across all trees.
If <code>cell_fates</code> not explicitly provided, use automatically determined cell fates based on tree dataset.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>all_trees_sorted</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a string representing a tree in NEWICK format. 
Trees are sorted using the <code>sort_align_tree</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_resamples</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of resample datasets.</p></td>
          <td>
                <code>10000</code>
          </td>
        </tr>
        <tr>
          <td><code>replacement_bool</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Sample cells with or without replacement drawing from the pool of all cells.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>cell_fates</code></td>
          <td>
                <code>string or list</code>
          </td>
          <td><p>If 'auto' (i.e. not provided by user), automatically determined 
based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>calc_expected</code></td>
          <td>
                <code>Boolean</code>
          </td>
          <td><p>Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>Contains the following variables.</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>triplet_dict (dict): Keys are triplets, values are integers.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>cell_fates (list): List where each entry is a string representing a cell fate.</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>dfs_c (DataFrame): Indexed by values from <code>triplet_dict</code>.
Last column is analytically solved expected number of each triplet.
Second to last column is observed number of occurences in the original dataset.
Rest of columns are the observed number of occurences in the resampled sets.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/resample.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="k">def</span> <span class="nf">resample_trees_triplets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> 
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>                            <span class="n">num_resamples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> 
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>                            <span class="n">replacement_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>                            <span class="n">cell_fates</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>                            <span class="n">calc_expected</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>                           <span class="p">):</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs resampling of tree, drawing with or without replacement, returning subtree dictionary and DataFrame containing </span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a><span class="sd">    number of triplets across all resamples, the original trees, and the expected number (solved analytically).</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">    Resampling is done via (1) replacing each cell with a randomly chosen non_doublet across all trees and </span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">    (2) replacing each doublet with a randomly chosen doublet across all trees.</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">    If `cell_fates` not explicitly provided, use automatically determined cell fates based on tree dataset.</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">        all_trees_sorted (list): List where each entry is a string representing a tree in NEWICK format. </span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="sd">            Trees are sorted using the `sort_align_tree` function.</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">        num_resamples (int, optional): Number of resample datasets.</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">        replacement_bool (bool, optional): Sample cells with or without replacement drawing from the pool of all cells.</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">        cell_fates (string or list, optional): If &#39;auto&#39; (i.e. not provided by user), automatically determined </span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">            based on tree dataset. User can also provide list where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">        calc_expected (Boolean): Calculate expected count if True by multiplying the marginal probabilities of each sub-pattern by the total number of subtrees</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">        (tuple): Contains the following variables.</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">        - triplet_dict (dict): Keys are triplets, values are integers.</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a><span class="sd">        - cell_fates (list): List where each entry is a string representing a cell fate.</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">        - dfs_c (DataFrame): Indexed by values from `triplet_dict`.</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">            Last column is analytically solved expected number of each triplet.</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">            Second to last column is observed number of occurences in the original dataset.</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">            Rest of columns are the observed number of occurences in the resampled sets.</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>    <span class="c1"># automatically determine cell fates if not explicitly provided</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>    <span class="k">if</span> <span class="n">cell_fates</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>        <span class="n">cell_fates</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[A-Z]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])))))</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>    <span class="c1"># _make_subtree_dict functions can only handle 10 cell fates max</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>    <span class="n">triplet_dict</span> <span class="o">=</span> <span class="n">_make_triplet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>    <span class="n">doublet_dict</span> <span class="o">=</span> <span class="n">_make_doublet_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>    <span class="n">cell_dict</span> <span class="o">=</span> <span class="n">_make_cell_dict</span><span class="p">(</span><span class="n">cell_fates</span><span class="p">)</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>    <span class="c1"># store result for each rearrangement in dfs list</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>    <span class="n">dfs_triplets_new</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>    <span class="n">df_triplets_true</span> <span class="o">=</span> <span class="n">_make_df_triplets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">triplet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>    <span class="n">df_doublets_true</span> <span class="o">=</span> <span class="n">_make_df_doublets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">doublet_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>    <span class="n">df_non_doublets_true</span> <span class="o">=</span> <span class="n">_make_df_non_doublets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">,</span> <span class="n">cell_dict</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>    <span class="c1"># rearrange leaves num_resamples times</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>    <span class="k">for</span> <span class="n">resample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">)):</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>        <span class="n">doublets_true</span> <span class="o">=</span> <span class="n">_flatten_doublets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>        <span class="n">non_doublets_true</span> <span class="o">=</span> <span class="n">_flatten_non_doublets</span><span class="p">(</span><span class="n">all_trees_sorted</span><span class="p">)</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>        <span class="c1"># shuffle if replacement=False</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>        <span class="k">if</span> <span class="n">replacement_bool</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">doublets_true</span><span class="p">)</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">non_doublets_true</span><span class="p">)</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>        <span class="c1"># first, replace the doublet with a symbol</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>        <span class="n">new_trees_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_doublets_symbol</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_trees_sorted</span><span class="p">]</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>        <span class="c1"># then, replace all other cells </span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>        <span class="n">new_trees_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_all</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">non_doublets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_trees_1</span><span class="p">]</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>        <span class="c1"># then, replace the symbols</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>        <span class="n">new_trees_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">_replace_symbols</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">doublets_true</span><span class="p">,</span> <span class="n">replacement_bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_trees_2</span><span class="p">]</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>        <span class="n">df_triplets_new</span> <span class="o">=</span> <span class="n">_make_df_triplets</span><span class="p">(</span><span class="n">new_trees_3</span><span class="p">,</span> <span class="n">triplet_dict</span><span class="p">,</span> <span class="n">resample</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>        <span class="n">dfs_triplets_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_triplets_new</span><span class="p">)</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>    <span class="n">dfs_c</span> <span class="o">=</span> <span class="n">_process_dfs_triplet</span><span class="p">(</span><span class="n">df_triplets_true</span><span class="p">,</span> <span class="n">dfs_triplets_new</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">,</span> <span class="n">triplet_dict</span><span class="p">,</span> <span class="n">doublet_dict</span><span class="p">,</span> <span class="n">cell_dict</span><span class="p">,</span> <span class="n">df_doublets_true</span><span class="p">,</span> <span class="n">df_non_doublets_true</span><span class="p">,</span> <span class="n">calc_expected</span><span class="p">)</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">triplet_dict</span><span class="p">,</span> <span class="n">cell_fates</span><span class="p">,</span> <span class="n">dfs_c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.resample.sort_align_tree" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sort_align_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Sort and align provided tree. </p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>tree</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Tree in NEWICK format.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>tree</code></td>          <td>
                <code>string</code>
          </td>
          <td><p>Tree in NEWICK format.
Trees are sorted to have all asymmetric septets in (x,(x,(x,(x,(x,(x,x)))))) format, asymmetric sextets in (x,(x,(x,(x,(x,x))))) format, 
asymmetric quintets in (x,(x,(x,(x,x)))), asymmetric quartets in (x,(x,(x,x))) format, triplets in (x,(x,x)) format, 
and all octets/quartets/doublets in alphabetical order.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/resample.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="k">def</span> <span class="nf">sort_align_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sort and align provided tree. </span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        tree (string): Tree in NEWICK format.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        tree (string): Tree in NEWICK format.</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">            Trees are sorted to have all asymmetric septets in (x,(x,(x,(x,(x,(x,x)))))) format, asymmetric sextets in (x,(x,(x,(x,(x,x))))) format, </span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            asymmetric quintets in (x,(x,(x,(x,x)))), asymmetric quartets in (x,(x,(x,x))) format, triplets in (x,(x,x)) format, </span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">            and all octets/quartets/doublets in alphabetical order.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="n">tree</span> <span class="o">=</span> <span class="n">_align_asym_septet</span><span class="p">(</span><span class="n">_align_asym_sextet</span><span class="p">(</span><span class="n">_align_asym_quintet</span><span class="p">(</span><span class="n">_align_asym_quartet</span><span class="p">(</span><span class="n">_align_sextet</span><span class="p">(</span><span class="n">_sorted_octets</span><span class="p">(</span><span class="n">_sorted_quartets</span><span class="p">(</span><span class="n">_sorted_doublets</span><span class="p">(</span><span class="n">_align_triplets</span><span class="p">(</span><span class="n">tree</span><span class="p">)))))))))</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="k">return</span> <span class="n">tree</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="lineage_motif.plot"></a>
  <div class="doc doc-contents first">
  
      <h3 id="lineage_motif.plot--lineage_motifplot">lineage_motif.plot</h3>
<p>Provides functions for visualizing motif analysis.</p>
<p>This module contains the following functions:</p>
<ul>
<li><code>dfs_for_plotting</code> - Takes DataFrame from <code>resample_trees</code> functions and returns DataFrame for plotting.</li>
<li><code>make_cell_color_dict</code> - Returns cell color dictionary based on provided cell fates.</li>
<li><code>plot_frequency</code> - Displays frequency plot of <code>cutoff</code> number of subtrees in original dataset and all resamples.</li>
<li><code>plot_deviation</code> - Displays deviation plot of <code>cutoff</code> number of subtrees in original dataset and a subset of resamples.</li>
<li><code>multi_dataset_dfs_for_plotting</code> - Takes DataFrame from <code>multi_dataset_resample_trees</code> function and returns DataFrames for plotting.</li>
<li><code>multi_dataset_plot_deviation</code> - Displays deviation plot of <code>cutoff</code> number of subtrees in multiple datasets.</li>
</ul>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="lineage_motif.plot.dfs_for_plotting" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dfs_for_plotting</span><span class="p">(</span><span class="n">dfs_c</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">,</span> <span class="n">subtree_dict</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">num_null</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">use_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_cell_types</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Converts DataFrame from resample_trees functions into DataFrames for plotting.</p>
<p>Calculates z-scores by comparing the observed count in the original trees to the mean/std across all resamples.
Calculates null z-scores by comparing the observed count of <code>num_null</code> random resamples to the mean/std across the rest of 
the resamples.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dfs_c</code></td>
          <td>
                <code>DataFrame</code>
          </td>
          <td><p>Indexed by values from <code>subtree_dict</code>.
Last column is analytically solved expected count of each subtree.
Second to last column is observed count of occurences in the original dataset.
Rest of columns are the observed count of occurences in the resampled sets.
Output from resample_trees functions.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_resamples</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of resamples.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>subtree_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Keys are subtrees, values are integers.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cutoff</code></td>
          <td>
                <code>string or NoneType or int</code>
          </td>
          <td><p>Take <code>cutoff</code> number of subtrees with largest absolute z-scores 
to include in plots.
If not provided explicitly, will be automatically determined to take all subtrees with abs z-score &gt; 1.
If NoneType, take all subtrees.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>num_null</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Take <code>num_null</code> number of resamples to calculate z-scores as part of null distribution.</p></td>
          <td>
                <code>1000</code>
          </td>
        </tr>
        <tr>
          <td><code>use_expected</code></td>
          <td>
                <code>Boolean</code>
          </td>
          <td><p>Use expected count in DataFrame.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>min_cell_types</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Use subtrees with only a minimal amount of different cell types.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>Contains the following DataFrames.</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>subtree_dict (dict): Keys are subtrees, values are integers. Remade using min_cell_types (excludes subtrees with lower min_cell_types).</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>df_true_melt_subset (DataFrame): DataFrame indexed by <code>cutoff</code> number of most significant subtrees for plotting.
Sorted by z-score from most over-represented to most under-represented. Contains the following columns: <ul>
<li>subtree_val (int): Value corresponding to <code>subtree_dict</code>.</li>
<li>observed (float): Count in original trees.</li>
<li>expected (float): Analytically solved expected count. Only included if use_expected is True.</li>
<li>z-score (float): Computed using observed values and mean/std across resamples.</li>
<li>abs z-score (float): Absolute value of z-score.</li>
<li>label (string): Key corresponding to <code>subtree_dict</code>.</li>
<li>null min (float): Minimum count across across all resamples.</li>
<li>null mean (float): Average count across across all resamples.</li>
<li>null max (float): Maximum count across across all resamples.</li>
<li>p_val (float): p-value, one-sided test, not corrected for multiple hypotheses testing. </li>
<li>adj_p_val_fdr_bh (float): adjusted p-value, corrected using the Benjamini and Hochberg FDR correction. Automatically set to 1 if min_cell_types &gt; 1.</li>
<li>adj_p_val_fdr_tsbh (float): adjusted p-value, corrected using the Benjamini and Hochberg FDR correction with two stage linear step-up procedure. Automatically set to 1 if min_cell_types &gt; 1.</li>
<li>null z-score min (float): Minimum z-score across across <code>num_null</code> random resamples.</li>
<li>null z-score mean (float): Average z-score across across <code>num_null</code> random resamples.</li>
<li>null z-score max (float): Maximum z-score across across <code>num_null</code> random resamples.</li>
</ul>
</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>df_melt_subset (DataFrame): Melted DataFrame with observed count for <code>cutoff</code> number of most significant subtrees 
across all resamples. Contains the following columns:<ul>
<li>subtree_val (int): Value corresponding to <code>subtree_dict</code>.</li>
<li>observed (int): Counts across all resamples.</li>
<li>label (string): Key corresponding to <code>subtree_dict</code>.</li>
</ul>
</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>df_melt_100resamples_subset (DataFrame): Melted DataFrame with observed count for <code>cutoff</code> number of most significant
subtrees across 100 random resamples. Contains the following columns:<ul>
<li>subtree_val (int): Value corresponding to <code>subtree_dict</code>.</li>
<li>observed (int): Counts across 100 random resamples.</li>
<li>label (string): Key corresponding to <code>subtree_dict</code>.</li>
</ul>
</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>df_null_zscores_i_c_melt_subset (DataFrame): Melted DataFrame with null z-score for <code>cutoff</code> number of most significant
subtrees across <code>num_null</code> random resamples. Contains the following columns:<ul>
<li>subtree_val (int): Value corresponding to <code>subtree_dict</code>.</li>
<li>observed (float): Z-scores across <code>num_null</code> random resamples.</li>
<li>label (string): Key corresponding to <code>subtree_dict</code>.</li>
</ul>
</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>df_null_zscores_i_c_melt_100resamples_subset (DataFrame): Melted DataFrame with null z-score for <code>cutoff</code> number of 
most significant subtrees across 100 random resamples. Contains the following columns:<ul>
<li>subtree_val (int): Value corresponding to <code>subtree_dict</code>.</li>
<li>observed (float): Z-scores across 100 random resamples.</li>
<li>label (string): Key corresponding to <code>subtree_dict</code>.</li>
</ul>
</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/plot.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="k">def</span> <span class="nf">dfs_for_plotting</span><span class="p">(</span><span class="n">dfs_c</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">,</span> <span class="n">subtree_dict</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">num_null</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">use_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_cell_types</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts DataFrame from resample_trees functions into DataFrames for plotting.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    Calculates z-scores by comparing the observed count in the original trees to the mean/std across all resamples.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    Calculates null z-scores by comparing the observed count of `num_null` random resamples to the mean/std across the rest of </span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    the resamples.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        dfs_c (DataFrame): Indexed by values from `subtree_dict`.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            Last column is analytically solved expected count of each subtree.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">            Second to last column is observed count of occurences in the original dataset.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">            Rest of columns are the observed count of occurences in the resampled sets.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">            Output from resample_trees functions.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        num_resamples (int): Number of resamples.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        subtree_dict (dict): Keys are subtrees, values are integers.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        cutoff (string or NoneType or int, optional): Take `cutoff` number of subtrees with largest absolute z-scores </span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">            to include in plots.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">            If not provided explicitly, will be automatically determined to take all subtrees with abs z-score &gt; 1.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            If NoneType, take all subtrees.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        num_null (int, optional): Take `num_null` number of resamples to calculate z-scores as part of null distribution.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        use_expected (Boolean, optional): Use expected count in DataFrame.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        min_cell_types (int, optional): Use subtrees with only a minimal amount of different cell types.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        (tuple): Contains the following DataFrames.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        - subtree_dict (dict): Keys are subtrees, values are integers. Remade using min_cell_types (excludes subtrees with lower min_cell_types).</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        - df_true_melt_subset (DataFrame): DataFrame indexed by `cutoff` number of most significant subtrees for plotting.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">            Sorted by z-score from most over-represented to most under-represented. Contains the following columns: </span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">                - subtree_val (int): Value corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">                - observed (float): Count in original trees.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">                - expected (float): Analytically solved expected count. Only included if use_expected is True.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">                - z-score (float): Computed using observed values and mean/std across resamples.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">                - abs z-score (float): Absolute value of z-score.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">                - label (string): Key corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">                - null min (float): Minimum count across across all resamples.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">                - null mean (float): Average count across across all resamples.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">                - null max (float): Maximum count across across all resamples.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">                - p_val (float): p-value, one-sided test, not corrected for multiple hypotheses testing. </span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">                - adj_p_val_fdr_bh (float): adjusted p-value, corrected using the Benjamini and Hochberg FDR correction. Automatically set to 1 if min_cell_types &gt; 1.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">                - adj_p_val_fdr_tsbh (float): adjusted p-value, corrected using the Benjamini and Hochberg FDR correction with two stage linear step-up procedure. Automatically set to 1 if min_cell_types &gt; 1.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">                - null z-score min (float): Minimum z-score across across `num_null` random resamples.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">                - null z-score mean (float): Average z-score across across `num_null` random resamples.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">                - null z-score max (float): Maximum z-score across across `num_null` random resamples.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        - df_melt_subset (DataFrame): Melted DataFrame with observed count for `cutoff` number of most significant subtrees </span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            across all resamples. Contains the following columns:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">                - subtree_val (int): Value corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">                - observed (int): Counts across all resamples.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">                - label (string): Key corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        - df_melt_100resamples_subset (DataFrame): Melted DataFrame with observed count for `cutoff` number of most significant</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            subtrees across 100 random resamples. Contains the following columns:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">                - subtree_val (int): Value corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">                - observed (int): Counts across 100 random resamples.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">                - label (string): Key corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        - df_null_zscores_i_c_melt_subset (DataFrame): Melted DataFrame with null z-score for `cutoff` number of most significant</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">            subtrees across `num_null` random resamples. Contains the following columns:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">                - subtree_val (int): Value corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">                - observed (float): Z-scores across `num_null` random resamples.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">                - label (string): Key corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        - df_null_zscores_i_c_melt_100resamples_subset (DataFrame): Melted DataFrame with null z-score for `cutoff` number of </span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            most significant subtrees across 100 random resamples. Contains the following columns:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">                - subtree_val (int): Value corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">                - observed (float): Z-scores across 100 random resamples.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">                - label (string): Key corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="c1"># remake subtree_dict based on min_cell_types</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">subtree_ss</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">subtree_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="n">cell_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;[A-Za-z0-9]+&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_types</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">min_cell_types</span><span class="p">:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="n">subtree_ss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">subtree_dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">subtree_ss</span><span class="p">):</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">subtree_dict</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="c1"># subset dfs_c by subtree_dict</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">dfs_c</span> <span class="o">=</span> <span class="n">dfs_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">subtree_ss</span><span class="p">]]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="c1"># slice out the subtrees of the original trees</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">df_true_slice</span> <span class="o">=</span> <span class="n">dfs_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;observed&#39;</span><span class="p">]</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="c1"># dataframe of original trees</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">:</span> <span class="n">df_true_slice</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="s1">&#39;observed&#39;</span><span class="p">:</span> <span class="n">df_true_slice</span><span class="o">.</span><span class="n">values</span><span class="p">}</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">df_true_melt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="c1"># slice out the subtrees of the original trees</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">if</span> <span class="n">use_expected</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">expected</span> <span class="o">=</span> <span class="n">dfs_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;expected&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="c1"># dataframe of resampled trees</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">resamples</span> <span class="o">=</span> <span class="n">num_resamples</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="n">df_melt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">dfs_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">resamples</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="n">df_melt_100resamples</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">dfs_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="s1">&#39;99&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="c1"># calculate zscores</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="n">zscores</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">df_true_slice</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">actual</span> <span class="o">=</span> <span class="n">df_true_slice</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df_melt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;observed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_melt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;observed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="k">if</span> <span class="n">std</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="n">zscore</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>            <span class="n">zscore</span> <span class="o">=</span> <span class="p">(</span><span class="n">actual</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">std</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">zscores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zscore</span><span class="p">)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="c1"># assign to dataframe and subset based on subtrees with top 10 significance values</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="k">if</span> <span class="n">use_expected</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;expected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">expected</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;z-score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zscores</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;abs z-score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;z-score&#39;</span><span class="p">])</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="n">df_true_melt</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="n">df_true_melt</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;abs z-score&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="c1"># subset based on the number of subtrees</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="k">if</span> <span class="n">cutoff</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">cutoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;abs z-score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="n">df_true_melt_subset</span> <span class="o">=</span> <span class="n">df_true_melt</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">cutoff</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">elif</span> <span class="n">cutoff</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="n">df_true_melt_subset</span> <span class="o">=</span> <span class="n">df_true_melt</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">df_true_melt_subset</span> <span class="o">=</span> <span class="n">df_true_melt</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">cutoff</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="n">df_true_melt_subset</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;z-score&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">subtree_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="c1"># exit early if all z-scores are 0</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;z-score&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">subtree_dict</span><span class="p">,</span> <span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="c1"># subset the resamples</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">df_melt_subset_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">df_melt_subtree</span> <span class="o">=</span> <span class="n">df_melt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">df_melt_subtree</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">subtree_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">df_melt_subset_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_melt_subtree</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="n">df_melt_subset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_melt_subset_list</span><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="n">df_melt_100resamples_subset_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">df_melt_100resamples_subtree</span> <span class="o">=</span> <span class="n">df_melt_100resamples</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_melt_100resamples</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="n">df_melt_100resamples_subtree</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">subtree_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">df_melt_100resamples_subset_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_melt_100resamples_subtree</span><span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="n">df_melt_100resamples_subset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_melt_100resamples_subset_list</span><span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;null min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_melt_subset</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]]</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;null mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_melt_subset</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]]</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;null max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_melt_subset</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]]</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="c1"># calculate p-value (one-sided test)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="n">p_val_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;z-score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">resamples</span> <span class="o">=</span> <span class="n">dfs_c</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="n">actual</span> <span class="o">=</span> <span class="n">df_true_melt_subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;observed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="n">pos</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">resamples</span><span class="o">&gt;=</span><span class="n">actual</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="k">elif</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="n">pos</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">resamples</span><span class="o">&lt;=</span><span class="n">actual</span><span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="n">pos</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">resamples</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">p_val</span> <span class="o">=</span> <span class="n">pos</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">resamples</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="n">p_val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_val</span><span class="p">)</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;p_val&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_val_list</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">if</span> <span class="n">min_cell_types</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;adj_p_val_fdr_bh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multipletests</span><span class="p">(</span><span class="n">p_val_list</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fdr_bh&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;adj_p_val_fdr_tsbh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multipletests</span><span class="p">(</span><span class="n">p_val_list</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fdr_tsbh&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">elif</span> <span class="n">min_cell_types</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;adj_p_val_fdr_bh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;adj_p_val_fdr_tsbh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="c1"># calculate deviation of each resample</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="n">df_null_zscores_i_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_null</span><span class="p">)):</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">df_true_slice_i</span> <span class="o">=</span> <span class="n">dfs_c</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">:</span> <span class="n">df_true_slice_i</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                <span class="s1">&#39;observed&#39;</span><span class="p">:</span> <span class="n">df_true_slice_i</span><span class="o">.</span><span class="n">values</span><span class="p">}</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">df_true_melt_i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="k">if</span> <span class="n">use_expected</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="n">df_subset_i</span> <span class="o">=</span> <span class="n">dfs_c</span><span class="p">[</span><span class="n">dfs_c</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">~</span><span class="n">dfs_c</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="s1">&#39;expected&#39;</span><span class="p">])]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="n">df_subset_i</span> <span class="o">=</span> <span class="n">dfs_c</span><span class="p">[</span><span class="n">dfs_c</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">~</span><span class="n">dfs_c</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;observed&#39;</span><span class="p">])]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">df_melt_i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">df_subset_i</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">zscores_i</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">df_true_slice_i</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="n">actual</span> <span class="o">=</span> <span class="n">df_true_slice_i</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df_melt_i</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_melt_i</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;observed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_melt_i</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_melt_i</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;observed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="k">if</span> <span class="n">std</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                <span class="n">zscore</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>                <span class="n">zscore</span> <span class="o">=</span> <span class="p">(</span><span class="n">actual</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">std</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="n">zscores_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zscore</span><span class="p">)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">df_null_zscores_i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">zscores_i</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">df_null_zscores_i_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_null_zscores_i</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="n">df_null_zscores_i_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_null_zscores_i_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="n">df_null_zscores_i_c</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="n">df_null_zscores_i_c_melt</span> <span class="o">=</span> <span class="n">df_null_zscores_i_c</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="n">df_null_zscores_i_c_melt_100resamples</span> <span class="o">=</span> <span class="n">df_null_zscores_i_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,:</span><span class="mi">99</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="c1"># subset the resamples</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="n">df_null_zscores_i_c_melt_subset_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">df_null_zscores_i_c_melt_subtree</span> <span class="o">=</span> <span class="n">df_null_zscores_i_c_melt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_null_zscores_i_c_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="n">df_null_zscores_i_c_melt_subtree</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">subtree_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="n">df_null_zscores_i_c_melt_subset_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt_subtree</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="n">df_null_zscores_i_c_melt_subset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt_subset_list</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="c1"># subset the resamples</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="n">df_null_zscores_i_c_melt_100resamples_subset_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="n">df_null_zscores_i_c_melt_100resamples_subtree</span> <span class="o">=</span> <span class="n">df_null_zscores_i_c_melt_100resamples</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_null_zscores_i_c_melt_100resamples</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="n">df_null_zscores_i_c_melt_100resamples_subtree</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">subtree_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="n">df_null_zscores_i_c_melt_100resamples_subset_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt_100resamples_subtree</span><span class="p">)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="n">df_null_zscores_i_c_melt_100resamples_subset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt_100resamples_subset_list</span><span class="p">)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;null z-score min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_null_zscores_i_c_melt_subset</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]]</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;null z-score mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_null_zscores_i_c_melt_subset</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]]</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;null z-score max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_null_zscores_i_c_melt_subset</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]]</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">subtree_dict</span><span class="p">,</span> <span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">df_melt_subset</span><span class="p">,</span> <span class="n">df_melt_100resamples_subset</span><span class="p">,</span> <span class="n">df_null_zscores_i_c_melt_subset</span><span class="p">,</span> <span class="n">df_null_zscores_i_c_melt_100resamples_subset</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.plot.make_color_dict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_color_dict</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Makes color dictionary based on provided labels (can be cell types or dataset names).</p>
<p>If cell_fates not provided, use automatically determined cell fates based on tree dataset.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>-</code></td>
          <td>
                <code>labels (list</code>
          </td>
          <td><p>List of string labels.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>-</code></td>
          <td>
                <code>colors (list</code>
          </td>
          <td><p>List of string color codes.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>color_dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td><p>Keys are labels, values are colors.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/plot.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="k">def</span> <span class="nf">make_color_dict</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Makes color dictionary based on provided labels (can be cell types or dataset names).</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">    If cell_fates not provided, use automatically determined cell fates based on tree dataset.</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        - labels (list): List of string labels.</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        - colors (list): List of string color codes.</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        color_dict (dict): Keys are labels, values are colors.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="n">color_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="p">))</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="k">return</span> <span class="n">color_dict</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.plot.multi_dataset_dfs_for_plotting" class="doc doc-heading">
<code class="highlight language-python"><span class="n">multi_dataset_dfs_for_plotting</span><span class="p">(</span><span class="n">dfs_dataset_c</span><span class="p">,</span> <span class="n">dataset_names</span><span class="p">,</span> <span class="n">num_resamples</span><span class="p">,</span> <span class="n">subtree_dict</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">num_null</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Converts DataFrame from <code>multi_dataset_resample_trees</code> function into DataFrames for plotting.</p>
<p>Calculates z-scores by comparing the observed count in the original trees to the mean/std across all resamples.
Calculates null z-scores by comparing the observed count of <code>num_null</code> random resamples to the mean/std across the rest of 
the resamples.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dfs_dataset_c</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a DataFrame with the following characteristics.
Indexed by values from <code>subtree_dict</code>.
Last column is dataset label.
Second to last column is analytically solved expected count of each subtree.
Third to last column is observed count of occurences in the original dataset.
Rest of columns are the observed count of occurences in the resampled sets.
Output from <code>multi_dataset_resample_trees</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dataset_names</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a string representing the dataset label. </p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_resamples</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of resamples.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>subtree_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Keys are subtrees, values are integers.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cutoff</code></td>
          <td>
                <code>string or NoneType or int</code>
          </td>
          <td><p>Takes <code>cutoff</code> number of subtrees with largest absolute z-scores 
across all datasets to include in plots.
If not provided explicitly, will be automatically determined to take all subtrees with abs z-score &gt; 1
    in at least one of the datasets provided.
If NoneType, take all subtrees.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>num_null</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Takes <code>num_null</code> number of resamples to calculate z-scores as part of null distribution.</p></td>
          <td>
                <code>1000</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>Contains the following DataFrames.</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>df_true_melt_dataset_label_c_c (DataFrame): DataFrame indexed by <code>cutoff</code> number of most significant subtrees for plotting.
Sorted by z-score from most over-represented to most under-represented (using the most extreme z-score
for each subtree across all datasets provided). Contains the following columns:<ul>
<li>subtree_val (int): Value corresponding to <code>subtree_dict</code>.</li>
<li>observed (float): Count in original trees.</li>
<li>expected (float): Analytically solved expected count.</li>
<li>z-score (float): Computed using observed values and mean/std across resamples.</li>
<li>abs z-score (float): Absolute value of z-score.</li>
<li>label (string): Key corresponding to <code>subtree_dict</code>.</li>
<li>null min (float): Minimum count across across all resamples.</li>
<li>null mean (float): Average count across across all resamples.</li>
<li>null max (float): Maximum count across across all resamples.</li>
<li>p_val (float): p-value, one-sided test, not corrected for multiple hypotheses testing.</li>
<li>adj_p_val_fdr_bh (float): adjusted p-value, corrected using the Benjamini and Hochberg FDR correction</li>
<li>adj_p_val_fdr_tsbh (float): adjusted p-value, corrected using the Benjamini and Hochberg FDR correction with two stage linear step-up procedure</li>
<li>dataset (string): Dataset label.</li>
<li>null z-score min (float): Minimum z-score across across <code>num_null</code> random resamples.</li>
<li>null z-score mean (float): Average z-score across across <code>num_null</code> random resamples.</li>
<li>null z-score max (float): Maximum z-score across across <code>num_null</code> random resamples.</li>
</ul>
</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>df_melt_subset_c_c (DataFrame): Melted DataFrame with observed count for <code>cutoff</code> number of most significant subtrees 
across all resamples. Contains the following columns:<ul>
<li>subtree_val (int): Value corresponding to <code>subtree_dict</code>.</li>
<li>observed (int): Counts across all resamples.</li>
<li>label (string): Key corresponding to <code>subtree_dict</code>.</li>
<li>dataset (string): Dataset label.</li>
</ul>
</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>df_melt_100resamples_subset_c_c (DataFrame): Melted DataFrame with observed count for <code>cutoff</code> number of most significant
subtrees across 100 random resamples. Contains the following columns:<ul>
<li>subtree_val (int): Value corresponding to <code>subtree_dict</code>.</li>
<li>observed (int): Counts across 100 random resamples.</li>
<li>label (string): Key corresponding to <code>subtree_dict</code>.</li>
<li>dataset (string): Dataset label.</li>
</ul>
</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>df_null_zscores_i_c_melt_subset_c_c (DataFrame): Melted DataFrame with null z-score for <code>cutoff</code> number of most significant
subtrees across <code>num_null</code> random resamples. Contains the following columns:<ul>
<li>subtree_val (int): Value corresponding to <code>subtree_dict</code>.</li>
<li>observed (float): Z-scores across <code>num_null</code> random resamples.</li>
<li>label (string): Key corresponding to <code>subtree_dict</code>.</li>
<li>dataset (string): Dataset label.</li>
</ul>
</li>
</ul></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><ul>
<li>df_null_zscores_i_c_melt_100resamples_subset_c_c (DataFrame): Melted DataFrame with null z-score for <code>cutoff</code> number of 
most significant subtrees across 100 random resamples. Contains the following columns:<ul>
<li>subtree_val (int): Value corresponding to <code>subtree_dict</code>.</li>
<li>observed (float): Z-scores across 100 random resamples.</li>
<li>label (string): Key corresponding to <code>subtree_dict</code>.</li>
<li>dataset (string): Dataset label.</li>
</ul>
</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/plot.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="k">def</span> <span class="nf">multi_dataset_dfs_for_plotting</span><span class="p">(</span><span class="n">dfs_dataset_c</span><span class="p">,</span> 
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>                                   <span class="n">dataset_names</span><span class="p">,</span> 
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>                                   <span class="n">num_resamples</span><span class="p">,</span> 
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>                                   <span class="n">subtree_dict</span><span class="p">,</span> 
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>                                   <span class="n">cutoff</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                                   <span class="n">num_null</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts DataFrame from `multi_dataset_resample_trees` function into DataFrames for plotting.</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">    Calculates z-scores by comparing the observed count in the original trees to the mean/std across all resamples.</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">    Calculates null z-scores by comparing the observed count of `num_null` random resamples to the mean/std across the rest of </span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">    the resamples.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">        dfs_dataset_c (list): List where each entry is a DataFrame with the following characteristics.</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">            Indexed by values from `subtree_dict`.</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">            Last column is dataset label.</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">            Second to last column is analytically solved expected count of each subtree.</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">            Third to last column is observed count of occurences in the original dataset.</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">            Rest of columns are the observed count of occurences in the resampled sets.</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">            Output from `multi_dataset_resample_trees` function.</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">        dataset_names (list): List where each entry is a string representing the dataset label. </span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">        num_resamples (int): Number of resamples.</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">        subtree_dict (dict): Keys are subtrees, values are integers.</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">        cutoff (string or NoneType or int, optional): Takes `cutoff` number of subtrees with largest absolute z-scores </span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">            across all datasets to include in plots.</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">            If not provided explicitly, will be automatically determined to take all subtrees with abs z-score &gt; 1</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">                in at least one of the datasets provided.</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">            If NoneType, take all subtrees.</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">        num_null (int, optional): Takes `num_null` number of resamples to calculate z-scores as part of null distribution.</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">        (tuple): Contains the following DataFrames.</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">        - df_true_melt_dataset_label_c_c (DataFrame): DataFrame indexed by `cutoff` number of most significant subtrees for plotting.</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">            Sorted by z-score from most over-represented to most under-represented (using the most extreme z-score</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">            for each subtree across all datasets provided). Contains the following columns:</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">                - subtree_val (int): Value corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">                - observed (float): Count in original trees.</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">                - expected (float): Analytically solved expected count.</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">                - z-score (float): Computed using observed values and mean/std across resamples.</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">                - abs z-score (float): Absolute value of z-score.</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">                - label (string): Key corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">                - null min (float): Minimum count across across all resamples.</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">                - null mean (float): Average count across across all resamples.</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">                - null max (float): Maximum count across across all resamples.</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">                - p_val (float): p-value, one-sided test, not corrected for multiple hypotheses testing.</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a><span class="sd">                - adj_p_val_fdr_bh (float): adjusted p-value, corrected using the Benjamini and Hochberg FDR correction</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">                - adj_p_val_fdr_tsbh (float): adjusted p-value, corrected using the Benjamini and Hochberg FDR correction with two stage linear step-up procedure</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">                - dataset (string): Dataset label.</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">                - null z-score min (float): Minimum z-score across across `num_null` random resamples.</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">                - null z-score mean (float): Average z-score across across `num_null` random resamples.</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">                - null z-score max (float): Maximum z-score across across `num_null` random resamples.</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">        - df_melt_subset_c_c (DataFrame): Melted DataFrame with observed count for `cutoff` number of most significant subtrees </span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="sd">            across all resamples. Contains the following columns:</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">                - subtree_val (int): Value corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">                - observed (int): Counts across all resamples.</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">                - label (string): Key corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">                - dataset (string): Dataset label.</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a><span class="sd">        - df_melt_100resamples_subset_c_c (DataFrame): Melted DataFrame with observed count for `cutoff` number of most significant</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="sd">            subtrees across 100 random resamples. Contains the following columns:</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a><span class="sd">                - subtree_val (int): Value corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">                - observed (int): Counts across 100 random resamples.</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a><span class="sd">                - label (string): Key corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a><span class="sd">                - dataset (string): Dataset label.</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">        - df_null_zscores_i_c_melt_subset_c_c (DataFrame): Melted DataFrame with null z-score for `cutoff` number of most significant</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">            subtrees across `num_null` random resamples. Contains the following columns:</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="sd">                - subtree_val (int): Value corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a><span class="sd">                - observed (float): Z-scores across `num_null` random resamples.</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">                - label (string): Key corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">                - dataset (string): Dataset label.</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">        - df_null_zscores_i_c_melt_100resamples_subset_c_c (DataFrame): Melted DataFrame with null z-score for `cutoff` number of </span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">            most significant subtrees across 100 random resamples. Contains the following columns:</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">                - subtree_val (int): Value corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a><span class="sd">                - observed (float): Z-scores across 100 random resamples.</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">                - label (string): Key corresponding to `subtree_dict`.</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">                - dataset (string): Dataset label.</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>    <span class="n">df_melt_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="n">df_melt_100resamples_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>    <span class="n">df_true_melt_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>    <span class="n">df_null_zscores_i_c_melt_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>    <span class="n">df_null_zscores_i_c_melt_100resamples_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">dataset_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset_names</span><span class="p">):</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>        <span class="n">dfs_c</span> <span class="o">=</span> <span class="n">dfs_dataset_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfs_dataset_c</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">dataset_name</span><span class="p">]</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>        <span class="c1"># slice out the triplets of the original trees</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="n">df_true_slice</span> <span class="o">=</span> <span class="n">dfs_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;observed&#39;</span><span class="p">]</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>        <span class="c1"># dataframe of original trees</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">:</span> <span class="n">df_true_slice</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>                <span class="s1">&#39;observed&#39;</span><span class="p">:</span> <span class="n">df_true_slice</span><span class="o">.</span><span class="n">values</span><span class="p">}</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="n">df_true_melt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>        <span class="c1"># slice out the triplets of the original trees</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="n">expected</span> <span class="o">=</span> <span class="n">dfs_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;expected&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="c1"># dataframe of resampled trees</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>        <span class="n">resamples</span> <span class="o">=</span> <span class="n">num_resamples</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>        <span class="n">df_melt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">dfs_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">resamples</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>        <span class="n">df_melt_100resamples</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">dfs_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="s1">&#39;99&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>        <span class="n">df_melt_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_melt</span><span class="p">)</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="n">df_melt_100resamples_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_melt_100resamples</span><span class="p">)</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>        <span class="c1"># calculate zscores</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>        <span class="n">zscores</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_slice</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>            <span class="n">actual</span> <span class="o">=</span> <span class="n">df_true_slice</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>            <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df_melt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;observed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>            <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_melt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;observed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>            <span class="k">if</span> <span class="n">std</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>                <span class="n">zscore</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>                <span class="n">zscore</span> <span class="o">=</span> <span class="p">(</span><span class="n">actual</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">std</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>            <span class="n">zscores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zscore</span><span class="p">)</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>        <span class="c1"># assign to dataframe and subset based on subtrees with top 10 significance values</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;expected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">expected</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;z-score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zscores</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;abs z-score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;z-score&#39;</span><span class="p">])</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>        <span class="n">df_true_melt</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>        <span class="n">df_true_melt</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;abs z-score&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">subtree_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;null min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_melt</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]]</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;null mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_melt</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]]</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;null max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_melt</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]]</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>        <span class="c1"># calculate p-value (one-sided test)</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>        <span class="n">p_val_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;z-score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>            <span class="n">resamples</span> <span class="o">=</span> <span class="n">dfs_c</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>            <span class="n">actual</span> <span class="o">=</span> <span class="n">df_true_melt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;observed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>            <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>                <span class="n">pos</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">resamples</span><span class="o">&gt;=</span><span class="n">actual</span><span class="p">)</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>            <span class="k">elif</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>                <span class="n">pos</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">resamples</span><span class="o">&lt;=</span><span class="n">actual</span><span class="p">)</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>            <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>                <span class="n">pos</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">resamples</span><span class="p">)</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>            <span class="n">p_val</span> <span class="o">=</span> <span class="n">pos</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">resamples</span><span class="p">)</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>            <span class="n">p_val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_val</span><span class="p">)</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;p_val&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_val_list</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;adj_p_val_fdr_bh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multipletests</span><span class="p">(</span><span class="n">p_val_list</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fdr_bh&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;adj_p_val_fdr_tsbh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multipletests</span><span class="p">(</span><span class="n">p_val_list</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fdr_tsbh&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>        <span class="n">df_true_melt_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_true_melt</span><span class="p">)</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>        <span class="c1"># calculate deviation of each resample</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>        <span class="n">df_null_zscores_i_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_null</span><span class="p">)):</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>            <span class="n">df_true_slice_i</span> <span class="o">=</span> <span class="n">dfs_c</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">:</span> <span class="n">df_true_slice_i</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>                    <span class="s1">&#39;observed&#39;</span><span class="p">:</span> <span class="n">df_true_slice_i</span><span class="o">.</span><span class="n">values</span><span class="p">}</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>            <span class="n">df_true_melt_i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>            <span class="n">df_subset_i</span> <span class="o">=</span> <span class="n">dfs_c</span><span class="p">[</span><span class="n">dfs_c</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">~</span><span class="n">dfs_c</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="s1">&#39;expected&#39;</span><span class="p">,</span> <span class="s1">&#39;dataset&#39;</span><span class="p">])]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>            <span class="n">df_melt_i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">df_subset_i</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>            <span class="n">zscores_i</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">df_true_slice_i</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>                <span class="n">actual</span> <span class="o">=</span> <span class="n">df_true_slice_i</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>                <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df_melt_i</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_melt_i</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;observed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>                <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_melt_i</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_melt_i</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;observed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>                <span class="k">if</span> <span class="n">std</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>                    <span class="n">zscore</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>                    <span class="n">zscore</span> <span class="o">=</span> <span class="p">(</span><span class="n">actual</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">std</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>                <span class="n">zscores_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zscore</span><span class="p">)</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>            <span class="n">df_null_zscores_i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">zscores_i</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>            <span class="n">df_null_zscores_i_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_null_zscores_i</span><span class="p">)</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>        <span class="n">df_null_zscores_i_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_null_zscores_i_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>        <span class="n">df_null_zscores_i_c</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>        <span class="n">df_null_zscores_i_c_melt</span> <span class="o">=</span> <span class="n">df_null_zscores_i_c</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>        <span class="n">df_null_zscores_i_c_melt_100resamples</span> <span class="o">=</span> <span class="n">df_null_zscores_i_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,:</span><span class="mi">99</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>        <span class="n">df_null_zscores_i_c_melt_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt</span><span class="p">)</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>        <span class="n">df_null_zscores_i_c_melt_100resamples_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt_100resamples</span><span class="p">)</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;null z-score min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_null_zscores_i_c_melt</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]]</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;null z-score mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_null_zscores_i_c_melt</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]]</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>        <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;null z-score max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_null_zscores_i_c_melt</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]]</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>    <span class="n">df_true_melt_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_true_melt_list</span><span class="p">)</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>    <span class="c1"># Loop through each subtree and take the highest absolute z-score across all datasets</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>    <span class="n">df_true_melt_c_label_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">subtree_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>        <span class="n">df_true_melt_c_label</span> <span class="o">=</span> <span class="n">df_true_melt_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_c</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_true_melt_c_label</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>            <span class="k">continue</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>        <span class="n">df_true_melt_c_label</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;abs z-score&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>        <span class="n">df_true_melt_c_label</span> <span class="o">=</span> <span class="n">df_true_melt_c_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>        <span class="n">df_true_melt_c_label_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_true_melt_c_label</span><span class="p">)</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>    <span class="n">df_true_melt_c_label_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_true_melt_c_label_list</span><span class="p">)</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>    <span class="n">df_true_melt_c_label_c</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;abs z-score&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>    <span class="c1"># Subset based on the cutoff number of subtrees</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>    <span class="k">if</span> <span class="n">cutoff</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>        <span class="n">cutoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_true_melt_c_label_c</span><span class="p">[</span><span class="s1">&#39;abs z-score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>        <span class="n">df_true_melt_c_label_c_subset</span> <span class="o">=</span> <span class="n">df_true_melt_c_label_c</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">cutoff</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>    <span class="k">elif</span> <span class="n">cutoff</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>        <span class="n">df_true_melt_c_label_c_subset</span> <span class="o">=</span> <span class="n">df_true_melt_c_label_c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>        <span class="n">df_true_melt_c_label_c_subset</span> <span class="o">=</span> <span class="n">df_true_melt_c_label_c</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">cutoff</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>    <span class="n">df_true_melt_c_label_c_subset</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;z-score&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>    <span class="c1"># Subset the z-score DataFrame based on the cutoff number of subtrees in the DataFrames for each dataset</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>    <span class="n">df_true_melt_dataset_label_c_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">dataset_names</span><span class="p">:</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>        <span class="n">df_true_melt_dataset</span> <span class="o">=</span> <span class="n">df_true_melt_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_c</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">dataset</span><span class="p">]</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>        <span class="n">df_true_melt_dataset_label_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_c_label_c_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>            <span class="n">df_true_melt_dataset_label</span> <span class="o">=</span> <span class="n">df_true_melt_dataset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_dataset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>            <span class="n">df_true_melt_dataset_label_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_true_melt_dataset_label</span><span class="p">)</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>        <span class="n">df_true_melt_dataset_label_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_true_melt_dataset_label_list</span><span class="p">)</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>        <span class="n">df_true_melt_dataset_label_c_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_true_melt_dataset_label_c</span><span class="p">)</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="n">df_true_melt_dataset_label_c_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_true_melt_dataset_label_c_list</span><span class="p">)</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>    <span class="c1"># Subset the melted DataFrames based on the cutoff number of subtrees in the DataFrames for each dataset</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>    <span class="n">df_melt_subset_c_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>    <span class="n">df_melt_100resamples_subset_c_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>    <span class="n">df_null_zscores_i_c_melt_subset_c_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>    <span class="n">df_null_zscores_i_c_melt_100resamples_subset_c_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">df_melt</span><span class="p">,</span> 
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>                <span class="n">df_melt_100resamples</span><span class="p">,</span> 
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>                <span class="n">df_null_zscores_i_c_melt</span><span class="p">,</span> 
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>                <span class="n">df_null_zscores_i_c_melt_100resamples</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df_melt_list</span><span class="p">,</span> 
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>                                                                        <span class="n">df_melt_100resamples_list</span><span class="p">,</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>                                                                        <span class="n">df_null_zscores_i_c_melt_list</span><span class="p">,</span> 
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>                                                                        <span class="n">df_null_zscores_i_c_melt_100resamples_list</span><span class="p">)):</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>        <span class="n">df_melt_subset_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_c_label_c_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>            <span class="n">df_melt_subtree</span> <span class="o">=</span> <span class="n">df_melt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>            <span class="n">df_melt_subtree</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">subtree_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>            <span class="n">df_melt_subset_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_melt_subtree</span><span class="p">)</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>        <span class="n">df_melt_subset_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_melt_subset_list</span><span class="p">)</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>        <span class="n">df_melt_subset_c</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>        <span class="n">df_melt_subset_c_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_melt_subset_c</span><span class="p">)</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>        <span class="n">df_melt_100resamples_subset_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_c_label_c_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>            <span class="n">df_melt_100resamples_subtree</span> <span class="o">=</span> <span class="n">df_melt_100resamples</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_melt_100resamples</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>            <span class="n">df_melt_100resamples_subtree</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">subtree_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>            <span class="n">df_melt_100resamples_subset_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_melt_100resamples_subtree</span><span class="p">)</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>        <span class="n">df_melt_100resamples_subset_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_melt_100resamples_subset_list</span><span class="p">)</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>        <span class="n">df_melt_100resamples_subset_c</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>        <span class="n">df_melt_100resamples_subset_c_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_melt_100resamples_subset_c</span><span class="p">)</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>        <span class="n">df_null_zscores_i_c_melt_subset_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_c_label_c_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>            <span class="n">df_null_zscores_i_c_melt_subtree</span> <span class="o">=</span> <span class="n">df_null_zscores_i_c_melt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_null_zscores_i_c_melt</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>            <span class="n">df_null_zscores_i_c_melt_subtree</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">subtree_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>            <span class="n">df_null_zscores_i_c_melt_subset_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt_subtree</span><span class="p">)</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>        <span class="n">df_null_zscores_i_c_melt_subset_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt_subset_list</span><span class="p">)</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>        <span class="n">df_null_zscores_i_c_melt_subset_c</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>        <span class="n">df_null_zscores_i_c_melt_subset_c_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt_subset_c</span><span class="p">)</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>        <span class="n">df_null_zscores_i_c_melt_100resamples_subset_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_true_melt_c_label_c_subset</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>            <span class="n">df_null_zscores_i_c_melt_100resamples_subtree</span> <span class="o">=</span> <span class="n">df_null_zscores_i_c_melt_100resamples</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_null_zscores_i_c_melt_100resamples</span><span class="p">[</span><span class="s1">&#39;subtree_val&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>            <span class="n">df_null_zscores_i_c_melt_100resamples_subtree</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">subtree_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>            <span class="n">df_null_zscores_i_c_melt_100resamples_subset_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt_100resamples_subtree</span><span class="p">)</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>        <span class="n">df_null_zscores_i_c_melt_100resamples_subset_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt_100resamples_subset_list</span><span class="p">)</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>        <span class="n">df_null_zscores_i_c_melt_100resamples_subset_c</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>        <span class="n">df_null_zscores_i_c_melt_100resamples_subset_c_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt_100resamples_subset_c</span><span class="p">)</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>    <span class="n">df_melt_subset_c_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_melt_subset_c_list</span><span class="p">)</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>    <span class="n">df_melt_100resamples_subset_c_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_melt_100resamples_subset_c_list</span><span class="p">)</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>    <span class="n">df_null_zscores_i_c_melt_subset_c_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt_subset_c_list</span><span class="p">)</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>    <span class="n">df_null_zscores_i_c_melt_100resamples_subset_c_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_null_zscores_i_c_melt_100resamples_subset_c_list</span><span class="p">)</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">df_true_melt_dataset_label_c_c</span><span class="p">,</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>            <span class="n">df_melt_subset_c_c</span><span class="p">,</span> 
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>            <span class="n">df_melt_100resamples_subset_c_c</span><span class="p">,</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>            <span class="n">df_null_zscores_i_c_melt_subset_c_c</span><span class="p">,</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>            <span class="n">df_null_zscores_i_c_melt_100resamples_subset_c_c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.plot.multi_dataset_plot_deviation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">multi_dataset_plot_deviation</span><span class="p">(</span><span class="n">subtree</span><span class="p">,</span> <span class="n">dataset_names</span><span class="p">,</span> <span class="n">df_true_melt_dataset_label_c_c</span><span class="p">,</span> <span class="n">dataset_color_dict</span><span class="p">,</span> <span class="n">cell_color_dict</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">legend_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_pos</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">image_format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">image_save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Plots deviation of <code>cutoff</code> number of subtrees in multiple datasets.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>subtree</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Type of subtree.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dataset_names</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>List where each entry is a string representing the dataset label. </p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df_true_melt_dataset_label_c_c</code></td>
          <td>
                <code>DataFrame</code>
          </td>
          <td><p>DataFrame with cutoff number of most significant subtrees for plotting.
Sorted by z-score from most over-represented to most under-represented.
Output from <code>multi_dataset_dfs_for_plotting</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dataset_color_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Keys are dataset names, values are colors.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cell_color_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Keys are cell fates, values are colors.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cutoff</code></td>
          <td>
                <code>string or NoneType or int</code>
          </td>
          <td><p>Take <code>cutoff</code> number of subtrees with largest absolute z-scores 
to include in plots.
If not provided explicitly, will be automatically determined to take all subtrees with abs z-score &gt; 1.
If NoneType, take all subtrees.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Title to use for plot. If not provided explicitly, will be automatically determined to read <code>subtree</code> frequency.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>legend_bool</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Include legend in plot.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>legend_pos</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Position of legend (outside or inside).</p></td>
          <td>
                <code>&#39;outside&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>save</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If True, save figure as file.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>image</code></td>
          <td>
                <code>format (string</code>
          </td>
          <td><p>Format of image file to be saved (png or svg).</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dpi</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Resolution of saved image file.</p></td>
          <td>
                <code>300</code>
          </td>
        </tr>
        <tr>
          <td><code>image_save_path</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Path to saved image file.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/plot.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span>
<span class="normal"><a href="#__codelineno-0-982">982</a></span>
<span class="normal"><a href="#__codelineno-0-983">983</a></span>
<span class="normal"><a href="#__codelineno-0-984">984</a></span>
<span class="normal"><a href="#__codelineno-0-985">985</a></span>
<span class="normal"><a href="#__codelineno-0-986">986</a></span>
<span class="normal"><a href="#__codelineno-0-987">987</a></span>
<span class="normal"><a href="#__codelineno-0-988">988</a></span>
<span class="normal"><a href="#__codelineno-0-989">989</a></span>
<span class="normal"><a href="#__codelineno-0-990">990</a></span>
<span class="normal"><a href="#__codelineno-0-991">991</a></span>
<span class="normal"><a href="#__codelineno-0-992">992</a></span>
<span class="normal"><a href="#__codelineno-0-993">993</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="k">def</span> <span class="nf">multi_dataset_plot_deviation</span><span class="p">(</span><span class="n">subtree</span><span class="p">,</span> 
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>                                 <span class="n">dataset_names</span><span class="p">,</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>                                 <span class="n">df_true_melt_dataset_label_c_c</span><span class="p">,</span> 
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>                                 <span class="n">dataset_color_dict</span><span class="p">,</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>                                 <span class="n">cell_color_dict</span><span class="p">,</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>                                 <span class="n">cutoff</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>                                 <span class="n">title</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>                                 <span class="n">legend_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>                                 <span class="n">legend_pos</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>                                 <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>                                 <span class="n">image_format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>                                 <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>                                 <span class="n">image_save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots deviation of `cutoff` number of subtrees in multiple datasets.</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">        subtree (string): Type of subtree.</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">        dataset_names (list): List where each entry is a string representing the dataset label. </span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">        df_true_melt_dataset_label_c_c (DataFrame): DataFrame with cutoff number of most significant subtrees for plotting.</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">            Sorted by z-score from most over-represented to most under-represented.</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">            Output from `multi_dataset_dfs_for_plotting` function.</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">        dataset_color_dict (dict): Keys are dataset names, values are colors.</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">        cell_color_dict (dict): Keys are cell fates, values are colors.</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">        cutoff (string or NoneType or int, optional): Take `cutoff` number of subtrees with largest absolute z-scores </span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">            to include in plots.</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">            If not provided explicitly, will be automatically determined to take all subtrees with abs z-score &gt; 1.</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">            If NoneType, take all subtrees.</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">        title (string, optional): Title to use for plot. If not provided explicitly, will be automatically determined to read `subtree` frequency.</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">        legend_bool (bool, optional): Include legend in plot.</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">        legend_pos (string, optional): Position of legend (outside or inside).</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">        save (bool, optional): If True, save figure as file.</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">        image format (string, optional): Format of image file to be saved (png or svg).</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">        dpi (int, optional): Resolution of saved image file.</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">        image_save_path (string, optional): Path to saved image file.</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>    <span class="n">margins</span><span class="o">=</span><span class="mf">0.05</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">0.23</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df_true_melt_dataset_label_c_c</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset_names</span><span class="p">)</span><span class="o">+</span><span class="n">margins</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">collections</span><span class="p">)</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;No deviation&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset_names</span><span class="p">):</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;z-score&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_true_melt_dataset_label_c_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_dataset_label_c_c</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">dataset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">dataset_color_dict</span><span class="p">[</span><span class="n">dataset</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">i</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_true_melt_dataset_label_c_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_dataset_label_c_c</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">dataset</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">df_true_melt_dataset_label_c_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_dataset_label_c_c</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">dataset</span><span class="p">][</span><span class="s1">&#39;z-score&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">dataset_color_dict</span><span class="p">[</span><span class="n">dataset</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>    <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Deviation from resamples&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span><span class="c1">#, fontweight=&#39;bold&#39;)</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span><span class="c1">#, fontweight=&#39;bold&#39;)</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;z-score&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>    <span class="k">if</span> <span class="n">legend_bool</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>        <span class="n">legend_props</span> <span class="o">=</span> <span class="n">font_manager</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>        <span class="k">if</span> <span class="n">legend_pos</span> <span class="o">==</span> <span class="s1">&#39;outside&#39;</span><span class="p">:</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">legend_props</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span><span class="mf">1.0</span><span class="p">))</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>        <span class="k">elif</span> <span class="n">legend_pos</span> <span class="o">==</span> <span class="s1">&#39;inside&#39;</span><span class="p">:</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">legend_props</span><span class="p">)</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">artist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">findobj</span><span class="p">(</span><span class="n">PathCollection</span><span class="p">)):</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>        <span class="n">artist</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>    <span class="k">for</span> <span class="n">subtree_label</span> <span class="ow">in</span> <span class="n">df_true_melt_dataset_label_c_c</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_dataset_label_c_c</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">dataset_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>        <span class="n">_make_annotation</span><span class="p">(</span><span class="n">cell_color_dict</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">subtree_label</span><span class="p">,</span> <span class="n">subtree</span><span class="p">)</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>    <span class="n">labelpad</span> <span class="o">=</span> <span class="n">df_annotations</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_annotations</span><span class="p">[</span><span class="s1">&#39;subtree_type&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">subtree</span><span class="p">][</span><span class="s1">&#39;labelpad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>    <span class="k">if</span> <span class="n">cutoff</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;All </span><span class="si">{</span><span class="n">subtree</span><span class="si">}</span><span class="s1"> combinations&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="n">labelpad</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">subtree</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s1"> combinations </span><span class="se">\n</span><span class="s1">(top </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_true_melt_dataset_label_c_c</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset_names</span><span class="p">))</span><span class="si">}</span><span class="s1"> by abs z-score)&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="n">labelpad</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>    <span class="k">if</span> <span class="n">save</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">image_save_path</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">image_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.plot.plot_deviation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_deviation</span><span class="p">(</span><span class="n">subtree</span><span class="p">,</span> <span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">df_null_zscores_i_c_melt_subset</span><span class="p">,</span> <span class="n">df_null_zscores_i_c_melt_100resamples_subset</span><span class="p">,</span> <span class="n">cell_color_dict</span><span class="p">,</span> <span class="n">fdr_type</span><span class="o">=</span><span class="s1">&#39;fdr_tsbh&#39;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">multiple_datasets</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_pos</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">image_format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">image_save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Plots deviation of <code>cutoff</code> number of subtrees in original dataset and <code>num_null</code> resamples.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>subtree</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Type of subtree.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df_true_melt_subset</code></td>
          <td>
                <code>DataFrame</code>
          </td>
          <td><p>DataFrame with cutoff number of most significant subtrees for plotting.
Sorted by z-score from most over-represented to most under-represented.
Output from <code>dfs_for_plotting</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df_null_zscores_i_c_melt_subset</code></td>
          <td>
                <code>DataFrame</code>
          </td>
          <td><p>Melted DataFrame with null z-score for <code>cutoff</code> number of most significant
subtrees across <code>num_null</code> random resamples.
Output from <code>dfs_for_plotting</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df_null_zscores_i_c_melt_100resamples_subset</code></td>
          <td>
                <code>DataFrame</code>
          </td>
          <td><p>Melted DataFrame with null z-score for <code>cutoff</code> number of 
most significant subtrees across 100 random resamples.
Output from <code>dfs_for_plotting</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cell_color_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Keys are cell fates, values are colors.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fdr_type</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Use the Benjamini and Hochberg FDR correction if 'fdr_bh', use Benjamini and Hochberg FDR correction
with two stage linear step-up procedure if 'fdr_tsbh'. Uses 'fdr_tsbh' by default.</p></td>
          <td>
                <code>&#39;fdr_tsbh&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cutoff</code></td>
          <td>
                <code>string or NoneType or int</code>
          </td>
          <td><p>Take <code>cutoff</code> number of subtrees with largest absolute z-scores 
to include in plots.
If not provided explicitly, will be automatically determined to take all subtrees with abs z-score &gt; 1.
If NoneType, take all subtrees.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Title to use for plot. If not provided explicitly, will be automatically determined to read <code>subtree</code> frequency.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>multiple_datasets</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Modify x-axis label depending if single or multiple datasets were used.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>legend_bool</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Include legend in plot.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>legend_pos</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Position of legend (outside or inside).</p></td>
          <td>
                <code>&#39;outside&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>save</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If True, save figure as file.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>image</code></td>
          <td>
                <code>format (string</code>
          </td>
          <td><p>Format of image file to be saved (png or svg).</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dpi</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Resolution of saved image file.</p></td>
          <td>
                <code>300</code>
          </td>
        </tr>
        <tr>
          <td><code>image_save_path</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Path to saved image file.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/plot.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="k">def</span> <span class="nf">plot_deviation</span><span class="p">(</span><span class="n">subtree</span><span class="p">,</span> 
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                   <span class="n">df_true_melt_subset</span><span class="p">,</span> 
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                   <span class="n">df_null_zscores_i_c_melt_subset</span><span class="p">,</span> 
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                   <span class="n">df_null_zscores_i_c_melt_100resamples_subset</span><span class="p">,</span> 
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>                   <span class="n">cell_color_dict</span><span class="p">,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                   <span class="n">fdr_type</span><span class="o">=</span><span class="s1">&#39;fdr_tsbh&#39;</span><span class="p">,</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>                   <span class="n">cutoff</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>                   <span class="n">title</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>                   <span class="n">multiple_datasets</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>                   <span class="n">legend_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>                   <span class="n">legend_pos</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>                   <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>                   <span class="n">image_format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>                   <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>                   <span class="n">image_save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots deviation of `cutoff` number of subtrees in original dataset and `num_null` resamples.</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">        subtree (string): Type of subtree.</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">        df_true_melt_subset (DataFrame): DataFrame with cutoff number of most significant subtrees for plotting.</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">            Sorted by z-score from most over-represented to most under-represented.</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">            Output from `dfs_for_plotting` function.</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        df_null_zscores_i_c_melt_subset (DataFrame): Melted DataFrame with null z-score for `cutoff` number of most significant</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">            subtrees across `num_null` random resamples.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            Output from `dfs_for_plotting` function.</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">        df_null_zscores_i_c_melt_100resamples_subset (DataFrame): Melted DataFrame with null z-score for `cutoff` number of </span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">            most significant subtrees across 100 random resamples.</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">            Output from `dfs_for_plotting` function.</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        cell_color_dict (dict): Keys are cell fates, values are colors.</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">        fdr_type (string, optional): Use the Benjamini and Hochberg FDR correction if &#39;fdr_bh&#39;, use Benjamini and Hochberg FDR correction</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">            with two stage linear step-up procedure if &#39;fdr_tsbh&#39;. Uses &#39;fdr_tsbh&#39; by default.</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">        cutoff (string or NoneType or int, optional): Take `cutoff` number of subtrees with largest absolute z-scores </span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">            to include in plots.</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">            If not provided explicitly, will be automatically determined to take all subtrees with abs z-score &gt; 1.</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">            If NoneType, take all subtrees.</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">        title (string, optional): Title to use for plot. If not provided explicitly, will be automatically determined to read `subtree` frequency.</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">        multiple_datasets (bool, optional): Modify x-axis label depending if single or multiple datasets were used.</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        legend_bool (bool, optional): Include legend in plot.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">        legend_pos (string, optional): Position of legend (outside or inside).</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">        save (bool, optional): If True, save figure as file.</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">        image format (string, optional): Format of image file to be saved (png or svg).</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">        dpi (int, optional): Resolution of saved image file.</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">        image_save_path (string, optional): Path to saved image file.</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="n">df_true_melt_subset_sg</span> <span class="o">=</span> <span class="n">df_true_melt_subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_subset</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;adj_p_val_</span><span class="si">{</span><span class="n">fdr_type</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="n">margins</span><span class="o">=</span><span class="mf">0.05</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">0.23</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df_true_melt_subset</span><span class="p">)</span><span class="o">+</span><span class="n">margins</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">collections</span><span class="p">)</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>    <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>                   <span class="n">y</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>                   <span class="n">data</span><span class="o">=</span><span class="n">df_null_zscores_i_c_melt_subset</span><span class="p">,</span> 
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>                   <span class="n">cut</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>                   <span class="n">inner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>                   <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#BCBEC0&#39;</span><span class="p">,</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>                   <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;width&#39;</span><span class="p">,</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>                   <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>                   <span class="p">)</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>                  <span class="n">y</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>                  <span class="n">data</span><span class="o">=</span><span class="n">df_null_zscores_i_c_melt_100resamples_subset</span><span class="p">,</span> 
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>                  <span class="n">jitter</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>                  <span class="n">size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>                 <span class="p">)</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;z-score&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed count&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;null z-score mean&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Null z-score across resamples&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;null z-score mean&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Average null z-score&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;null z-score min&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;null z-score max&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;z-score&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="c1">#pyplot.scatter(x=&quot;label&quot;, y=&quot;z-score&quot;, data=df_true_melt_subset_sg, color=&#39;red&#39;, s=25, alpha=0.35, label=&#39;Adjusted p-value &lt; 0.05&#39;)</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>    <span class="c1"># add annotations for adjusted p-value</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">df_true_melt_subset_sg</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="n">adj_p_val</span> <span class="o">=</span> <span class="n">df_true_melt_subset_sg</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_subset_sg</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">label</span><span class="p">][</span><span class="sa">f</span><span class="s1">&#39;adj_p_val_</span><span class="si">{</span><span class="n">fdr_type</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="n">val</span> <span class="o">=</span> <span class="n">df_true_melt_subset_sg</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_subset_sg</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">label</span><span class="p">][</span><span class="s1">&#39;z-score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="n">null</span> <span class="o">=</span> <span class="n">df_true_melt_subset_sg</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_subset_sg</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">label</span><span class="p">][</span><span class="s1">&#39;null z-score mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">null</span><span class="p">:</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>            <span class="n">y_coord</span> <span class="o">=</span> <span class="n">val</span><span class="o">+</span><span class="nb">max</span><span class="p">(</span><span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;z-score&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">10</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">_annot</span><span class="p">(</span><span class="n">adj_p_val</span><span class="p">),</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">y_coord</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>            <span class="n">y_coord</span> <span class="o">=</span> <span class="n">val</span><span class="o">-</span><span class="nb">max</span><span class="p">(</span><span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;z-score&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">10</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">_annot</span><span class="p">(</span><span class="n">adj_p_val</span><span class="p">),</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">y_coord</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>    <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Deviation from resamples&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span><span class="c1">#, fontweight=&#39;bold&#39;)</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span><span class="c1">#, fontweight=&#39;bold&#39;)</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;z-score&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>    <span class="k">if</span> <span class="n">legend_bool</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="n">legend_props</span> <span class="o">=</span> <span class="n">font_manager</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="k">if</span> <span class="n">legend_pos</span> <span class="o">==</span> <span class="s1">&#39;outside&#39;</span><span class="p">:</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">legend_props</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span><span class="mf">1.0</span><span class="p">))</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="k">elif</span> <span class="n">legend_pos</span> <span class="o">==</span> <span class="s1">&#39;inside&#39;</span><span class="p">:</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">legend_props</span><span class="p">)</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">artist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">findobj</span><span class="p">(</span><span class="n">PathCollection</span><span class="p">)):</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="n">artist</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>    <span class="k">for</span> <span class="n">subtree_label</span> <span class="ow">in</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="n">_make_annotation</span><span class="p">(</span><span class="n">cell_color_dict</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">subtree_label</span><span class="p">,</span> <span class="n">subtree</span><span class="p">)</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>    <span class="n">labelpad</span> <span class="o">=</span> <span class="n">df_annotations</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_annotations</span><span class="p">[</span><span class="s1">&#39;subtree_type&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">subtree</span><span class="p">][</span><span class="s1">&#39;labelpad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="k">if</span> <span class="n">cutoff</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;All </span><span class="si">{</span><span class="n">subtree</span><span class="si">}</span><span class="s1"> combinations&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="n">labelpad</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>        <span class="k">if</span> <span class="n">multiple_datasets</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">subtree</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s1"> combinations </span><span class="se">\n</span><span class="s1">(top </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_true_melt_subset</span><span class="p">)</span><span class="si">}</span><span class="s1"> by abs z-score)&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="n">labelpad</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">subtree</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s1"> combinations </span><span class="se">\n</span><span class="s1">(top </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_true_melt_subset</span><span class="p">)</span><span class="si">}</span><span class="s1"> by abs z-score across all datasets)&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="n">labelpad</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>    <span class="k">if</span> <span class="n">save</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">image_save_path</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">image_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="lineage_motif.plot.plot_frequency" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_frequency</span><span class="p">(</span><span class="n">subtree</span><span class="p">,</span> <span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">df_melt_subset</span><span class="p">,</span> <span class="n">df_melt_100resamples_subset</span><span class="p">,</span> <span class="n">cell_color_dict</span><span class="p">,</span> <span class="n">use_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fdr_type</span><span class="o">=</span><span class="s1">&#39;fdr_tsbh&#39;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">multiple_datasets</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_pos</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">image_format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">image_save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Plots frequency of <code>cutoff</code> number of subtrees in original dataset and all resamples.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>subtree</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Type of subtree.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df_true_melt_subset</code></td>
          <td>
                <code>DataFrame</code>
          </td>
          <td><p>DataFrame with <code>cutoff</code> number of most significant subtrees for plotting.
Sorted by z-score from most over-represented to most under-represented.
Output from <code>dfs_for_plotting</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df_melt_subset</code></td>
          <td>
                <code>DataFrame</code>
          </td>
          <td><p>Melted DataFrame with observed count for <code>cutoff</code> number of most significant subtrees 
across all resamples.
Output from <code>dfs_for_plotting</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df_melt_100resamples_subset</code></td>
          <td>
                <code>DataFrame</code>
          </td>
          <td><p>Melted DataFrame with observed count for <code>cutoff</code> number of most significant
subtrees across 100 random resamples.
Output from <code>dfs_for_plotting</code> function.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cell_color_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Keys are cell fates, values are colors.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>use_expected</code></td>
          <td>
                <code>Boolean</code>
          </td>
          <td><p>Use expected count in DataFrame.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>fdr_type</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Use the Benjamini and Hochberg FDR correction if 'fdr_bh', use Benjamini and Hochberg FDR correction
with two stage linear step-up procedure if 'fdr_tsbh'. Uses 'fdr_tsbh' by default.</p></td>
          <td>
                <code>&#39;fdr_tsbh&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cutoff</code></td>
          <td>
                <code>string or NoneType or int</code>
          </td>
          <td><p>Take <code>cutoff</code> number of subtrees with largest absolute z-scores 
to include in plots.
If not provided explicitly, will be automatically determined to take all subtrees with abs z-score &gt; 1.
If NoneType, take all subtrees.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Title to use for plot. If not provided explicitly, will be automatically determined to read <code>subtree</code> frequency.</p></td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>multiple_datasets</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Modify x-axis label depending if single or multiple datasets were used.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>legend_bool</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Include legend in plot.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>legend_pos</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Position of legend (outside or inside).</p></td>
          <td>
                <code>&#39;outside&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>save</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If True, save figure as file.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>image</code></td>
          <td>
                <code>format (string</code>
          </td>
          <td><p>Format of image file to be saved (png or svg).</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dpi</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Resolution of saved image file.</p></td>
          <td>
                <code>300</code>
          </td>
        </tr>
        <tr>
          <td><code>image_save_path</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Path to saved image file.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/plot.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="k">def</span> <span class="nf">plot_frequency</span><span class="p">(</span><span class="n">subtree</span><span class="p">,</span> 
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>                   <span class="n">df_true_melt_subset</span><span class="p">,</span> 
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                   <span class="n">df_melt_subset</span><span class="p">,</span> 
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                   <span class="n">df_melt_100resamples_subset</span><span class="p">,</span> 
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>                   <span class="n">cell_color_dict</span><span class="p">,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>                   <span class="n">use_expected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>                   <span class="n">fdr_type</span><span class="o">=</span><span class="s1">&#39;fdr_tsbh&#39;</span><span class="p">,</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>                   <span class="n">cutoff</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>                   <span class="n">title</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>                   <span class="n">multiple_datasets</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                   <span class="n">legend_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                   <span class="n">legend_pos</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                   <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                   <span class="n">image_format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>                   <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>                   <span class="n">image_save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots frequency of `cutoff` number of subtrees in original dataset and all resamples.</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">        subtree (string): Type of subtree.</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">        df_true_melt_subset (DataFrame): DataFrame with `cutoff` number of most significant subtrees for plotting.</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">            Sorted by z-score from most over-represented to most under-represented.</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">            Output from `dfs_for_plotting` function.</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">        df_melt_subset (DataFrame): Melted DataFrame with observed count for `cutoff` number of most significant subtrees </span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">            across all resamples.</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">            Output from `dfs_for_plotting` function.</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        df_melt_100resamples_subset (DataFrame): Melted DataFrame with observed count for `cutoff` number of most significant</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">            subtrees across 100 random resamples.</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">            Output from `dfs_for_plotting` function.</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        cell_color_dict (dict): Keys are cell fates, values are colors.</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">        use_expected (Boolean): Use expected count in DataFrame.</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">        fdr_type (string, optional): Use the Benjamini and Hochberg FDR correction if &#39;fdr_bh&#39;, use Benjamini and Hochberg FDR correction</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">            with two stage linear step-up procedure if &#39;fdr_tsbh&#39;. Uses &#39;fdr_tsbh&#39; by default.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">        cutoff (string or NoneType or int, optional): Take `cutoff` number of subtrees with largest absolute z-scores </span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">            to include in plots.</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">            If not provided explicitly, will be automatically determined to take all subtrees with abs z-score &gt; 1.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">            If NoneType, take all subtrees.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        title (string, optional): Title to use for plot. If not provided explicitly, will be automatically determined to read `subtree` frequency.</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        multiple_datasets (bool, optional): Modify x-axis label depending if single or multiple datasets were used.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        legend_bool (bool, optional): Include legend in plot.</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        legend_pos (string, optional): Position of legend (outside or inside).</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">        save (bool, optional): If True, save figure as file.</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">        image format (string, optional): Format of image file to be saved (png or svg).</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">        dpi (int, optional): Resolution of saved image file.</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        image_save_path (string, optional): Path to saved image file.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>    <span class="n">df_true_melt_subset_sg</span> <span class="o">=</span> <span class="n">df_true_melt_subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_subset</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;adj_p_val_</span><span class="si">{</span><span class="n">fdr_type</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="n">margins</span><span class="o">=</span><span class="mf">0.05</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">0.23</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df_true_melt_subset</span><span class="p">)</span><span class="o">+</span><span class="n">margins</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">collections</span><span class="p">)</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                   <span class="n">y</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>                   <span class="n">data</span><span class="o">=</span><span class="n">df_melt_subset</span><span class="p">,</span> 
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>                   <span class="n">cut</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>                   <span class="n">inner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>                   <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#BCBEC0&#39;</span><span class="p">,</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>                   <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;width&#39;</span><span class="p">,</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>                   <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>                   <span class="p">)</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                  <span class="n">y</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                  <span class="n">data</span><span class="o">=</span><span class="n">df_melt_100resamples_subset</span><span class="p">,</span> 
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                  <span class="n">jitter</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>                  <span class="n">size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>                 <span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed count&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;null mean&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Count across all resamples&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="k">if</span> <span class="n">use_expected</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;expected&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Expected count&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;null min&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;null max&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_true_melt_subset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="c1">#pyplot.scatter(x=&#39;label&#39;, y=&#39;observed&#39;, data=df_true_melt_subset_sg, color=&#39;red&#39;, s=25, alpha=0.35, label=&#39;Adjusted p-value &lt; 0.05&#39;)</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="c1"># add annotations for adjusted p-value</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">df_true_melt_subset_sg</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="n">adj_p_val</span> <span class="o">=</span> <span class="n">df_true_melt_subset_sg</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_subset_sg</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">label</span><span class="p">][</span><span class="sa">f</span><span class="s1">&#39;adj_p_val_</span><span class="si">{</span><span class="n">fdr_type</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="n">val</span> <span class="o">=</span> <span class="n">df_true_melt_subset_sg</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_subset_sg</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">label</span><span class="p">][</span><span class="s1">&#39;observed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="n">null</span> <span class="o">=</span> <span class="n">df_true_melt_subset_sg</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_true_melt_subset_sg</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">label</span><span class="p">][</span><span class="s1">&#39;null mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">null</span><span class="p">:</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>            <span class="n">y_coord</span> <span class="o">=</span> <span class="n">val</span><span class="o">+</span><span class="nb">max</span><span class="p">(</span><span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;observed&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">10</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">_annot</span><span class="p">(</span><span class="n">adj_p_val</span><span class="p">),</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">y_coord</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>            <span class="n">y_coord</span> <span class="o">=</span> <span class="n">val</span><span class="o">-</span><span class="nb">max</span><span class="p">(</span><span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;observed&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">10</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">_annot</span><span class="p">(</span><span class="n">adj_p_val</span><span class="p">),</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">y_coord</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">subtree</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s1"> frequency&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span><span class="c1">#, fontweight=&#39;bold&#39;)</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span><span class="c1">#, fontweight=&#39;bold&#39;)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="k">if</span> <span class="n">legend_bool</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="n">legend_props</span> <span class="o">=</span> <span class="n">font_manager</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="k">if</span> <span class="n">legend_pos</span> <span class="o">==</span> <span class="s1">&#39;outside&#39;</span><span class="p">:</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">legend_props</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span><span class="mf">1.0</span><span class="p">))</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="k">elif</span> <span class="n">legend_pos</span> <span class="o">==</span> <span class="s1">&#39;inside&#39;</span><span class="p">:</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">legend_props</span><span class="p">)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">artist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">findobj</span><span class="p">(</span><span class="n">PathCollection</span><span class="p">)):</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="n">artist</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>    <span class="k">for</span> <span class="n">subtree_label</span> <span class="ow">in</span> <span class="n">df_true_melt_subset</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">_make_annotation</span><span class="p">(</span><span class="n">cell_color_dict</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">subtree_label</span><span class="p">,</span> <span class="n">subtree</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>    <span class="n">labelpad</span> <span class="o">=</span> <span class="n">df_annotations</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_annotations</span><span class="p">[</span><span class="s1">&#39;subtree_type&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">subtree</span><span class="p">][</span><span class="s1">&#39;labelpad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="k">if</span> <span class="n">cutoff</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;All </span><span class="si">{</span><span class="n">subtree</span><span class="si">}</span><span class="s1"> combinations&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="n">labelpad</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="k">if</span> <span class="n">multiple_datasets</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">subtree</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s1"> combinations </span><span class="se">\n</span><span class="s1">(top </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_true_melt_subset</span><span class="p">)</span><span class="si">}</span><span class="s1"> by abs z-score)&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="n">labelpad</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>            <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">subtree</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s1"> combinations </span><span class="se">\n</span><span class="s1">(top </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_true_melt_subset</span><span class="p">)</span><span class="si">}</span><span class="s1"> by abs z-score across all datasets)&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="n">labelpad</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;fontname&#39;</span><span class="p">:</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="k">if</span> <span class="n">save</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">image_save_path</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">image_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="lineage_motif.simulate"></a>
  <div class="doc doc-contents first">
  
      <h3 id="lineage_motif.simulate--lineage_motifsimulate">lineage_motif.simulate</h3>
<p>Provides functions for simulating lineage trees.</p>
<p>This module contains the following functions:
- <code>simulate_tree</code> - Simulate tree based on provided transition matrix and progenitor/cell type labels.</p>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="lineage_motif.simulate.simulate_tree" class="doc doc-heading">
<code class="highlight language-python"><span class="n">simulate_tree</span><span class="p">(</span><span class="n">transition_matrix</span><span class="p">,</span> <span class="n">starting_progenitor</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Simulate tree based on provided transition matrix and progenitor/cell type labels.
Progenitors are represented by lowercase letters, cell types are represented by uppercase letters.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>transition_matrix</code></td>
          <td>
                <code>array</code>
          </td>
          <td><p>matrix where rows represent original state, column represents state to transition into.
Rows should sum to 1 for progenitors.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>starting_progenitor</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>string with starting progenitor</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>labels</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>string with progenitor/cell type labels that correspond to the rows of the provided transition matrix.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>tree_input</code></td>          <td>
                <code>string</code>
          </td>
          <td><p>new tree in NEWICK format after simulated division until no progenitor cells remaining.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>lineage_motif/simulate.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="k">def</span> <span class="nf">simulate_tree</span><span class="p">(</span><span class="n">transition_matrix</span><span class="p">,</span> <span class="n">starting_progenitor</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Simulate tree based on provided transition matrix and progenitor/cell type labels.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Progenitors are represented by lowercase letters, cell types are represented by uppercase letters.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        transition_matrix (array): matrix where rows represent original state, column represents state to transition into.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">            Rows should sum to 1 for progenitors.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        starting_progenitor (string): string with starting progenitor</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        labels (string): string with progenitor/cell type labels that correspond to the rows of the provided transition matrix.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        tree_input (string): new tree in NEWICK format after simulated division until no progenitor cells remaining.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">tree_input</span> <span class="o">=</span> <span class="n">starting_progenitor</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="c1"># continue dividing if tree contains progenitors</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">while</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[a-z]&#39;</span><span class="p">,</span> <span class="n">tree_input</span><span class="p">)</span> <span class="o">!=</span> <span class="p">[]:</span> 
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="n">tree_input</span> <span class="o">=</span> <span class="n">_divide</span><span class="p">(</span><span class="n">tree_input</span><span class="p">,</span> <span class="n">transition_matrix</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="k">return</span> <span class="n">tree_input</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../installation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Installation" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Installation
            </div>
          </div>
        </a>
      
      
        
        <a href="../rat_retina/" class="md-footer__link md-footer__link--next" aria-label="Next: Tutorial 1 - Rat retina" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Tutorial 1 - Rat retina
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
    
    
  </body>
</html>